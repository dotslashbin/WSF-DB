<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.4" DspName="Microsoft.Data.Tools.Schema.Sql.Sql100DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="False" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="False" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="100" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="DB_RPOWine.dll" />
			<Metadata Name="FileName" Value="D:\PROJECTS\PROJECTS_2014\ALEX\REPOS_DBPROJ\DB_RPOWINE\DB_RPOWINE\OBJ\DEBUG\DB_RPOWINE.DLL" />
			<Metadata Name="AssemblyName" Value="DB_RPOWine" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="D:\PROJECTS\PROJECTS_2014\Alex\Repos_DBProj\DB_RPOWine\DB_RPOWine\obj\Debug\DB_RPOWine.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiPaddingOn" Value="False" />
			<Property Name="IsQuotedIdentifierOn" Value="False" />
			<Property Name="IsCursorDefaultScopeGlobal" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="RecoveryMode" Value="1" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Flag]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlFilegroup" Name="[Articles]" />
		<Element Type="SqlFilegroup" Name="[AuditLog]" />
		<Element Type="SqlTable" Name="[dbo].[Article]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[ReviewerID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[Title]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[Date]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[Notes]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Article].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[Articles]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[EntryDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[TypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[CategoryID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[SourceID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[UserNameID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[MachineNameID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[ObjectTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[ObjectID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="80" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[Description]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit].[Message]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[text]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Audit].[Audit_GetList]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[ObjectTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[ObjectID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[EntryDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[TypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[CategoryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[SourceID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[UserNameID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[MachineNameID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Audit_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
declare @Result int,
	@TypeID int, @CategoryID int, @SourceID int, @UserID int, @MachineID int, @ObjTypeID int

exec @TypeID = Audit_GetLookupID @ObjectName = 'entrytype', @ObjectValue = @Type
exec @CategoryID = Audit_GetLookupID @ObjectName = 'entrycategory', @ObjectValue = @Category
exec @SourceID = Audit_GetLookupID @ObjectName = 'entrysource', @ObjectValue = @Source
exec @UserID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
exec @MachineID = Audit_GetLookupID @ObjectName = 'entrymachine', @ObjectValue = @MachineName
exec @ObjTypeID = Audit_GetLookupID @ObjectName = 'objecttype', @ObjectValue = @ObjectType

if exists(select * from Audit_IDMapping (nolock) where ObjectTypeID = @ObjTypeID and OldObjectID = @ObjectID)
	select @ObjectID = NewObjectID from Audit_IDMapping (nolock) where ObjectTypeID = @ObjTypeID and OldObjectID = @ObjectID

insert into Audit ([EntryDate], [TypeID], [CategoryID], [SourceID], [UserNameID], [MachineNameID], 
	[ObjectTypeID], [ObjectID], [Description], [Message])
values (isnull(@EntryDate, getdate()), @TypeID, @CategoryID, @SourceID, @UserID, @MachineID, 
	@ObjTypeID, @ObjectID, @Description, @Message)
if @@error <> 0 begin
	select @Result = -1
end else begin
	select @Result = scope_identity()
end

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Category]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@MachineName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[OldObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[NewObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[OldObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[EntryDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[CategoryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[SourceID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[UserNameID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[MachineNameID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@EntryDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@EntryDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@Type]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@Category]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@Source]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@UserName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@MachineName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@ObjectType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@ObjectID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="80" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@Description]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@Message]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[text]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="192" />
				<Property Name="Length" Value="1969" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/22/14&#xD;&#xA;-- Description:&#x9;Adds new record to Audit Log.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Audit_Add]&#xD;&#xA;&#x9;@ID int = NULL,&#xD;&#xA;&#x9;@EntryDate datetime = NULL, @Type varchar(50), @Category varchar(50), &#xD;&#xA;&#x9;@Source varchar(50), @UserName varchar(50), @MachineName varchar(50), &#xD;&#xA;&#x9;@ObjectType varchar(50), @ObjectID varchar(80) = NULL,&#xD;&#xA;&#x9;@Description varchar(256), @Message text = '',&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_EntryCategories]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryCategories].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryCategories].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryCategories].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_EntryMachines]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryMachines].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryMachines].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryMachines].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="23" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_EntrySources]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntrySources].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntrySources].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntrySources].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="24" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="25" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_EntryTypes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryTypes].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryTypes].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryTypes].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="26" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="27" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_EntryUsers]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryUsers].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryUsers].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryUsers].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="28" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_EntryUsers].[Flag]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="7" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="29" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Audit_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @TotalCount int

if @ID is NOT NUll and @ID < 0
	set @ID = NULL

if @ID is NULL and @EntryDate is NULL and @Type is NULL and @Category is NULL 
	and @Source is NULL and @UserName is NULL and @MachineName is NULL 
	and	@ObjectType is NULL and @ObjectID is NULL 
	and @Description is NULL and @Message is NULL
	and @DateOpFrom is NULL and @DateOpTo is NULL begin
	
	raiserror('[USERERROR]: At least one filter parameter must be specified.', 16, 1)
	RETURN -1
end

if @DateOpTo is NOT NULL and datepart(hour,@DateOpFrom)=0 and datepart(minute,@DateOpFrom)=0
	and datepart(hour,@DateOpTo)=0 and datepart(minute,@DateOpTo)=0
	select @DateOpTo = dateadd(minute, 23*60+59, @DateOpTo)

if datalength(@Message) > 0 begin
	declare @searchStr nvarchar(256)
	set @searchStr = '%' + replace(substring(@Message, 0, 253), '[', '[[]') + '%'

	select @TotalCount = count(*)
	from Audit a (nolock)
		join Audit_EntryTypes at (nolock) on a.TypeID = at.ID
		join Audit_EntryCategories ac (nolock) on a.CategoryID = ac.ID
		--join Audit_EntrySources s (nolock) on a.SourceID = s.ID
		join Audit_EntryUsers au (nolock) on a.UserNameID = au.ID
		--join Audit_EntryMachines am (nolock) on a.MachineNameID = am.ID
		join Audit_ObjectTypes aot (nolock) on a.ObjectTypeID = aot.ID
	where a.ID = isnull(@ID, a.ID) 
		and EntryDate >= isnull(@EntryDate, '1/1/2000') 
		and upper(at.Name) = upper(isnull(@Type, at.Name)) 
		and upper(ac.Name) = upper(isnull(@Category, ac.Name)) 
		and upper(aot.Name) = upper(isnull(@ObjectType, aot.Name)) 
		and upper(ObjectID) = upper(isnull(@ObjectID, ObjectID)) 
		and upper(au.Name) = upper(isnull(@UserName, au.Name)) 
		and Message like @searchStr
		and (@DateOpFrom is NULL or @DateOpTo is NULL or (EntryDate >= @DateOpFrom and EntryDate <= @DateOpTo))

	; with r as (
		select
			ID = a.ID, 
			EntryDate, 
			Type = at.Name, 
			Category = ac.Name, 
			Source = s.Name, 
			UserName = au.Name, 
			MachineName = am.Name, 
			ObjectType = aot.Name, 
			ObjectID, 
			Description,
			Message = case when isnull(@ShowRes, 0) = 2 then '' else Message end,
			RowNumber = row_number() over (order by a.ID desc),
			TotalCount = isnull(@TotalCount, 0)
		from Audit a (nolock)
			join Audit_EntryTypes at (nolock) on a.TypeID = at.ID
			join Audit_EntryCategories ac (nolock) on a.CategoryID = ac.ID
			join Audit_EntrySources s (nolock) on a.SourceID = s.ID
			join Audit_EntryUsers au (nolock) on a.UserNameID = au.ID
			join Audit_EntryMachines am (nolock) on a.MachineNameID = am.ID
			join Audit_ObjectTypes aot (nolock) on a.ObjectTypeID = aot.ID
		where a.ID = isnull(@ID, a.ID) 
			and EntryDate >= isnull(@EntryDate, '1/1/2000') 
			and upper(at.Name) = upper(isnull(@Type, at.Name)) 
			and upper(ac.Name) = upper(isnull(@Category, ac.Name)) 
			and upper(aot.Name) = upper(isnull(@ObjectType, aot.Name)) 
			and upper(ObjectID) = upper(isnull(@ObjectID, ObjectID)) 
			and upper(au.Name) = upper(isnull(@UserName, au.Name)) 
			and Message like @searchStr
			and (@DateOpFrom is NULL or @DateOpTo is NULL or (EntryDate >= @DateOpFrom and EntryDate <= @DateOpTo))
	)
	select top 300 * from r
	where (@StartRow is NULL or @EndRow is NULL or (RowNumber between @StartRow and @EndRow))
	order by ID desc

end else begin
	select @TotalCount = count(*)
	from Audit a (nolock)
		join Audit_EntryTypes at (nolock) on a.TypeID = at.ID
		join Audit_EntryCategories ac (nolock) on a.CategoryID = ac.ID
		--join Audit_EntrySources s (nolock) on a.SourceID = s.ID
		join Audit_EntryUsers au (nolock) on a.UserNameID = au.ID
		--join Audit_EntryMachines am (nolock) on a.MachineNameID = am.ID
		join Audit_ObjectTypes aot (nolock) on a.ObjectTypeID = aot.ID
	where a.ID = isnull(@ID, a.ID) 
		and EntryDate >= isnull(@EntryDate, '1/1/2000') 
		and upper(at.Name) = upper(isnull(@Type, at.Name)) 
		and upper(ac.Name) = upper(isnull(@Category, ac.Name)) 
		and upper(aot.Name) = upper(isnull(@ObjectType, aot.Name)) 
		and upper(ObjectID) = upper(isnull(@ObjectID, ObjectID)) 
		and upper(au.Name) = upper(isnull(@UserName, au.Name))
		and (@DateOpFrom is NULL or @DateOpTo is NULL or (EntryDate >= @DateOpFrom and EntryDate <= @DateOpTo))

	; with r as (
		select 
			ID = a.ID, 
			EntryDate, 
			Type = at.Name, 
			Category = ac.Name, 
			Source = s.Name, 
			UserName = au.Name, 
			MachineName = am.Name, 
			ObjectType = aot.Name, 
			ObjectID, 
			Description,
			Message = case when isnull(@ShowRes, 0) = 2 then '' else Message end,
			RowNumber = row_number() over (order by a.ID desc),
			TotalCount = isnull(@TotalCount, 0)
		from Audit a (nolock)
			join Audit_EntryTypes at (nolock) on a.TypeID = at.ID
			join Audit_EntryCategories ac (nolock) on a.CategoryID = ac.ID
			join Audit_EntrySources s (nolock) on a.SourceID = s.ID
			join Audit_EntryUsers au (nolock) on a.UserNameID = au.ID
			join Audit_EntryMachines am (nolock) on a.MachineNameID = am.ID
			join Audit_ObjectTypes aot (nolock) on a.ObjectTypeID = aot.ID
		where a.ID = isnull(@ID, a.ID) 
			and EntryDate >= isnull(@EntryDate, '1/1/2000') 
			and upper(at.Name) = upper(isnull(@Type, at.Name)) 
			and upper(ac.Name) = upper(isnull(@Category, ac.Name)) 
			and upper(aot.Name) = upper(isnull(@ObjectType, aot.Name)) 
			and upper(ObjectID) = upper(isnull(@ObjectID, ObjectID)) 
			and upper(au.Name) = upper(isnull(@UserName, au.Name))
			and (@DateOpFrom is NULL or @DateOpTo is NULL or (EntryDate >= @DateOpFrom and EntryDate <= @DateOpTo))
	)
	select top 300 * from r
	where (@StartRow is NULL or @EndRow is NULL or (RowNumber between @StartRow and @EndRow))
	order by ID desc

end

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@EntryDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@Category]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@MachineName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@ObjectType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@DateOpFrom]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@DateOpTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[CategoryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[UserNameID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[EntryDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[SourceID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[UserNameID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[MachineNameID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[EntryDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@StartRow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetList].[@EndRow]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Audit_GetList].[CTE1].[r]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[EntryDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[EntryDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[Type]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryTypes].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[Category]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryCategories].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[Source]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntrySources].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[UserName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryUsers].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[MachineName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryMachines].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[ObjectType]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[ObjectID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[ObjectID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[Description]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[Description]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[Message]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[RowNumber]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE1].[r].[TotalCount]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Audit_GetList].[CTE2].[r]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[EntryDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[EntryDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[Type]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryTypes].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[Category]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryCategories].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[Source]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntrySources].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[UserName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryUsers].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[MachineName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_EntryMachines].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[ObjectType]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[ObjectID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[ObjectID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[Description]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Audit].[Description]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[Message]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[RowNumber]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Audit_GetList].[CTE2].[r].[TotalCount]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@EntryDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@Type]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@Category]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@Source]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@UserName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@MachineName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@ObjectType]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@ObjectID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="80" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@Description]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@Message]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[ntext]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@DateOpFrom]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@DateOpTo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@StartRow]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@EndRow]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="6329" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[Audit_GetList]&#xD;&#xA;&#x9;@ID int = NULL,&#xD;&#xA;&#x9;@EntryDate datetime = NULL, @Type varchar(50) = NULL, @Category varchar(50) = NULL, &#xD;&#xA;&#x9;@Source varchar(50) = NULL, @UserName varchar(50) = NULL, @MachineName varchar(50) = NULL, &#xD;&#xA;&#x9;@ObjectType varchar(50) = NULL, @ObjectID varchar(80) = NULL,&#xD;&#xA;&#x9;@Description nvarchar(256) = NULL, @Message ntext = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@DateOpFrom smalldatetime = NULL, @DateOpTo smalldatetime = NULL,&#xD;&#xA;&#x9;@StartRow int = NULL, @EndRow int = NULL,&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;exec Audit_GetList @ObjectType='WineProducer', @Message='&quot;name&quot;: &quot;Test'&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Audit_GetLookupID]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @Result int
set @ObjectValue = ltrim(rtrim(isnull(@ObjectValue, '')))

if (lower(@ObjectName) = 'entrytype') begin
	select @Result = ID from Audit_EntryTypes (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_EntryTypes (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'entrycategory') begin
	select @Result = ID from Audit_EntryCategories (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_EntryCategories (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'entrysource') begin
	select @Result = ID from Audit_EntrySources (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_EntrySources (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'entryuser') begin
	select @Result = ID from Audit_EntryUsers (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_EntryUsers (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'entrymachine') begin
	select @Result = ID from Audit_EntryMachines (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 begin	-- and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_EntryMachines (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'objecttype') begin
	select @Result = ID from Audit_ObjectTypes (nolock) where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and len(isnull(@ObjectValue,'')) > 0 begin
		insert into Audit_ObjectTypes (Name) values (@ObjectValue)
		select @Result = scope_identity()
	end
end

if isnull(@Result, 0) < 1
	raiserror('Cannot find or create an entry in the [%s] with value [%s].', 16, 1, @ObjectName, @ObjectValue)

RETURN isnull(@Result, 0)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetLookupID].[@ObjectName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Audit_GetLookupID].[@ObjectValue]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="365" />
				<Property Name="Length" Value="2697" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/22/14&#xD;&#xA;-- Description:&#x9;Gets internal ID of the lookup record.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;It will automatically add new records into lookup tables, if necessary.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Used in Audit_Add stored procedure and not intended to be used anywhere else.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Audit_GetLookupID]&#xD;&#xA;&#x9;@ObjectName as varchar(30), @ObjectValue as varchar(50)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_IDMapping]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_IDMapping].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_IDMapping].[ObjectTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_IDMapping].[OldObjectID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="80" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_IDMapping].[NewObjectID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="80" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_IDMapping].[DateOp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="30" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="31" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="32" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Audit_ObjectTypes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_ObjectTypes].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_ObjectTypes].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Audit_ObjectTypes].[DateOp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="33" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="34" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Article_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Article].[created]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="8" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Article_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Article].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntryCategories_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="20" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntryDate]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit].[EntryDate]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntryMachines_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="22" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntrySources_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntrySources]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="24" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntryTypes_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="26" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_EntryUsers_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="28" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_IDMapping_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_IDMapping]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_IDMapping].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="30" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Audit_ObjectTypes_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[DateOp]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="33" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Issue_Article_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Issue_Article].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="35" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Issue_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Issue].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="36" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Issue_TasteNote_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="37" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Issue_TastingEvent_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="38" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationCountry_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationCountry].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="39" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationCountry_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationCountry].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="40" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationLocale_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationLocale].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="41" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationLocale_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationLocale].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="42" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationLocation_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationLocation].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="43" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationLocation_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationLocation].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="44" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationRegion_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationRegion].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="45" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationRegion_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationRegion].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="46" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationSite_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationSite].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="47" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_LocationSite_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[LocationSite].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="48" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Publication_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Publication].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="49" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Publication_TasteNote_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="50" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Publisher_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publisher]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Publisher].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="51" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Publisher_IsPrimary]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publisher]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Publisher].[IsPrimary]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="52" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Reviewer_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Reviewer].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="53" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Reviewer_oldRevIdn]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Reviewer].[oldReviewerIdN]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="54" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Reviewer_UserId]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="55" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Reviewer_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Reviewer].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="56" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TasteNote_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TasteNote].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="57" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TasteNote_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="58" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TasteNotes_IsBarrelTasting]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TasteNote].[IsBarrelTasting]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="59" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TastingEvent_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TastingEvent].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="60" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TastingEvent_ParentID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="61" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TastingEvent_SortOrder]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TastingEvent].[SortOrder]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="62" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TastingEvent_TasteNote_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="63" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_TastingEvent_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="64" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_AssignedDate]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF].[AssignedDate]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="65" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_ObjectTypes_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[DateOp]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="66" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_Statuses_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="67" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_Statuses_SortOrder]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[SortOrder]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="68" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_Users_DateOp]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF_Users].[DateOp]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="69" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WF_Users_IsAvailable]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WF_Users].[IsAvailable]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="70" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Wine_N_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Wine_N].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="71" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Wine_N_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Wine_N].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="72" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Wine_VinN_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="73" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Wine_VinN_GroupID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="74" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_Wine_VinN_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="75" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineBottle_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineBottleSize].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="76" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineBottle_Volume]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineBottleSize].[Volume]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="77" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineBottle_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineBottleSize].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="78" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineColor_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineColor].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="79" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineColor_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineColor].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="80" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineDryne_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineDryness].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="81" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineDryne_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineDryness].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="82" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineLabel_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineLabel].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="83" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineLabel_DefaultColorID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((-1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultColorID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="84" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineLabel_DefaultDrynessID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((-1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultDrynessID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="85" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineLabel_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineLabel].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="86" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineMaturity_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineMaturity].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="87" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineProducer_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineProducer].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="88" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineProducer_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineProducer].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="89" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineType_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineType].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="90" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineType_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineType].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="91" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineVarie_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineVariety].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="92" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineVarie_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineVariety].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="93" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineVintage_created]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineVintage].[created]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="94" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF_WineVintage_WF_StatusID]">
			<Property Name="DefaultExpressionScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[WineVintage].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="95" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Article_Reviewer]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Article].[ReviewerID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="11" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_EntryCategories]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[CategoryID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_EntryMachines]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[MachineNameID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_EntrySources]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[SourceID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_EntrySources].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_EntrySources]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="16" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_EntryTypes]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[TypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="17" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_EntryUsers]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[UserNameID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="18" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Audit_Audit_ObjectTypes]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Audit].[ObjectTypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="19" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_Article_Article]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_Article].[ArticleID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Article].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="96" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_Article_Issue]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_Article].[IssueID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="97" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_Publication]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="98" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_TasteNote_Issue]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="99" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_TasteNote_TasteNote]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[TasteNoteID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="100" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_TastingEvent_Issue]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="101" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Issue_TastingEvent_TastingEvent]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[TastingEventID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="102" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_LocationCountry_WF_Statuses]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[LocationCountry].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="103" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_LocationLocale_WF_Statuses]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[LocationLocale].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="104" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_LocationLocation_WF_Statuses]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[LocationLocation].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="105" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_LocationRegion_WF_Statuses]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[LocationRegion].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="106" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_LocationSite_WF_Statuses]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[LocationSite].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="107" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Publication_Publisher]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Publication].[PublisherID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Publisher].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Publisher]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="108" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Publication_TasteNote_Publication]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote].[PublicationID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="109" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Publication_TasteNote_TasteNote]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote].[TasteNoteID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="110" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TasteNote_Reviewer]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="111" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TasteNote_Wine_N]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="112" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TasteNote_WineMaturity]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TasteNote].[MaturityID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineMaturity].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="113" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TastingEvent_Reviewer]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ReviewerID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="114" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TastingEvent_TasteNote_TasteNote]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="115" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TastingEvent_TasteNote_TastingEvent]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="116" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_TastingEvent_TastingEvent]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="117" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WF_WF_ObjectTypes]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="118" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WF_WF_Users]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="119" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WF_WF_Users1]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="120" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WFHist_WF]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WFHist]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="121" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_N_Wine_VinN]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="122" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_N_WineVintage]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="123" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_LocationCountry]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="124" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_LocationLocale]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="125" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_LocationLocation]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="126" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_LocationRegion]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="127" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_LocationSite]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="128" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineColor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="129" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineDryness]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="130" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineLabel]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="131" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineProducer]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="132" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineType]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="133" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Wine_VinN_WineVariety]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="134" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WineProducer_LocationCountry]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WineProducer].[locCountryID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="135" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WineProducer_LocationLocale]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocaleID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="136" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WineProducer_LocationLocation]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocationID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="137" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WineProducer_LocationRegion]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WineProducer].[locRegionID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="138" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_WineProducer_LocationSite]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[WineProducer].[locSiteID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="139" />
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[fn_GetAdjustedSearchString]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString].[@SearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Destination]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table].[Item]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table].[Item]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Destination]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN

	-- ===== special keywords =====
	declare @newSearchString nvarchar(1024) = '',
		@sS nvarchar(120), @sD nvarchar(240)

	-- complex phrases
	if charindex(' ', @SearchString) > 0 begin
		declare crPh CURSOR forward_only fast_forward read_only for
			select Source, Destination 
			from KeywordMap_Wine km (nolock) 
			where charindex(' ', km.Source) > 0
				and @SearchString like '%' + km.Source + '%'
		open crPh
		fetch next from crPh into @sS, @sD
		while @@fetch_status = 0 begin
			if @sS is NOT NULL begin
				select @SearchString = replace(@SearchString, @sS, '')
				if len(@newSearchString) > 0
					select @newSearchString += ' AND ' 
				select @newSearchString += case when @sD is null then @sS else @sD end
			end
			fetch next from crPh into @sS, @sD
		end
		close crPh
		deallocate crPh
	end

	select @SearchString = rtrim(ltrim(@SearchString))

	-- single words
	if len(@SearchString) > 0 begin
		if isnull(charindex(' ', @SearchString), 0) < 1 begin
			if len(@newSearchString) > 0
				select @newSearchString += ' AND ' 
			select @sD = Destination from KeywordMap_Wine (nolock) where Source = @SearchString
			select @newSearchString += case when @sD is null then @SearchString else @sD end
		end else begin
			declare cr CURSOR forward_only fast_forward read_only for
				select Source = f.Item, Destination 
				from dbo.String2Table(@SearchString, ' ') f 
					left join KeywordMap_Wine km (nolock) on km.Source = replace(f.Item, '"' , '')
				where f.Item != '""'

			open cr
			fetch next from cr into @sS, @sD
			while @@fetch_status = 0 begin
				if @sS is NOT NULL begin
					if len(@newSearchString) > 0
						select @newSearchString += ' AND ' 
					select @newSearchString += case when @sD is null then @sS else @sD end
				end
				fetch next from cr into @sS, @sD
			end
			close cr
			deallocate cr
		end
	end
	-- ===== end of special keywords =====

	RETURN @newSearchString

END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="404" />
							<Property Name="Length" Value="2494" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Alex B.&#xD;&#xA;-- Create date: 1/18/2014&#xD;&#xA;-- Description:&#x9;Adjusts a string using &quot;macroses&quot; defined in the KeywordMap_Wine&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;AND prepares it to be used in the full text search quesries (no spaces inside)&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Used in Wine and WineVin search queries. &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Macroses are for the Label Name.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE FUNCTION fn_GetAdjustedSearchString&#xD;&#xA;(&#xD;&#xA;&#x9;@SearchString nvarchar(1024)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(1024)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[fn_GetAdjustedSearchString].[@SearchString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="1024" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[fn_GetObjectDescription]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Title]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
BEGIN
	declare @msg nvarchar(1024)

	if (lower(@ObjectName) = 'wineproducer') begin
		select @msg = '{"WineProducer": {'
			+ '"id": ' + cast(ID as varchar(20)) 
			+ ', "name": "' + Name + '"'
			+ ', "nameToShow": "' + NameToShow + '"'
			+ ', "WebSiteURL": "' + isnull(WebSiteURL, '') + '"'
			+ '}}'
		from WineProducer (nolock)
		where ID = @ObjectID
	end else 
	if (lower(@ObjectName) = 'issue') begin
		select @msg = '{"Issue": {'
			+ '"id": ' + cast(i.ID as varchar(20)) 
			+ ', "PublicationName": "' + p.Name + '"'
			+ ', "Title": "' + i.Title + '"'
			+ ', "PublicationDate": "' + isnull(cast(i.PublicationDate as varchar(20)), '') + '"'
			+ '}}'
		from Issue i (nolock)
			join Publication p (nolock) on i.PublicationID = p.ID
		where i.ID = @ObjectID
	end
	
	RETURN @msg
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="272" />
							<Property Name="Length" Value="1218" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author: Alex B.&#xD;&#xA;-- Create date: 1/22/2014&#xD;&#xA;-- Description:&#x9;Gets description of the record in JSON format.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Used to auto generate text in AuditLog functionality.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE FUNCTION [dbo].[fn_GetObjectDescription]&#xD;&#xA;(&#xD;&#xA;&#x9;@ObjectName as varchar(30), @ObjectID as int&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(1024)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[fn_GetObjectDescription].[@ObjectName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[fn_GetObjectDescription].[@ObjectID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="1024" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTableType" Name="[dbo].[IDLink]">
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlTableTypeSimpleColumn" Name="[dbo].[IDLink].[LeftID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlTableTypeSimpleColumn" Name="[dbo].[IDLink].[RightID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTableType" Name="[dbo].[IDList]">
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlTableTypeSimpleColumn" Name="[dbo].[IDList].[ID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Issue]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[PublicationID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[ChiefEditorID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[Title]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[CreatedDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[PublicationDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[Notes]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="36" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="140" />
			<AttachedAnnotation Disambiguator="98" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Issue].[IX_Issue_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue].[PublicationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue].[Title]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Issue_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

------------ Checks
if not exists(select * from Publication (nolock) where ID = @PublicationID) begin
	raiserror('Issue_Add:: Publication record with ID=%i does not exist.', 16, 1, @PublicationID)
	RETURN -1
end

if @ChiefEditorID is NOT NULL 
	select @ChiefEditorID = ID from Reviewer (nolock) where ID = @ChiefEditorID
else if @ChiefEditorUserID is NOT NULL
	select @ChiefEditorID = ID from Reviewer (nolock) where UserId = @ChiefEditorUserID
else
	select @ChiefEditorID = ID from Reviewer (nolock) where Name = @ChiefEditorName

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TasteNote_Add:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
---------- Checks

BEGIN TRY
	BEGIN TRANSACTION

	insert into Issue (PublicationID, ChiefEditorID, Title, 
		CreatedDate, PublicationDate, Notes,
		created, updated)
	values (@PublicationID, @ChiefEditorID, @Title, 
		@CreatedDate, @PublicationDate, @Notes,
		getdate(), null)
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		select @Result = scope_identity()
		--declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('Issue', @Result)
		--exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
		--	@ObjectType='Issue', @ObjectID=@Result, @Description='Issue added', @Message=@msg,
		--	@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@ChiefEditorUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@ChiefEditorName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Add].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@PublicationID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@ChiefEditorID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@ChiefEditorUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@ChiefEditorName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@Title]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@CreatedDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@PublicationDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@Notes]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="180" />
				<Property Name="Length" Value="2972" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/4/2014&#xD;&#xA;-- Description:&#x9;Adds new Issue.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Issue_Add]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@PublicationID int,&#xD;&#xA;&#x9;@ChiefEditorID int = NULL, @ChiefEditorUserID int = NULL, @ChiefEditorName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Title nvarchar(255),&#xD;&#xA;&#x9;@CreatedDate date, @PublicationDate date,&#xD;&#xA;&#x9;@Notes nvarchar(max),&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = Issue_Add @@ChiefEditorID=2, @Title = 'Test Issue # 1',&#xD;&#xA;&#x9;@CreatedDate = '2/1/2013', @PublicationDate = '2/12/2013',&#xD;&#xA;&#x9;@Notes = 'Just testing...'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Issue_Article]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_Article].[IssueID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_Article].[ArticleID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_Article].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="35" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="141" />
			<AttachedAnnotation Disambiguator="96" />
			<AttachedAnnotation Disambiguator="97" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Issue_Del]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int

------------ Checks
if not exists(select * from Issue (nolock) where ID = @ID) begin
	raiserror('Issue_Del:: Issue record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

------------ Audit Log
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('Issue_Del:: @UserName is required.', 16, 1)
--	RETURN -1
--end
----exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	--declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('Issue', @ID)
	
	delete Issue_Article where IssueID = @ID
	delete Issue_TasteNote where IssueID = @ID
	delete Issue_TastingEvent where IssueID = @ID
	delete Issue where ID = @ID
	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	exec Audit_Add @Type='Success', @Category='Delete', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='Issue', @ObjectID=@ID, @Description='Issue deleted', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Del].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Del].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Del].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Del].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="216" />
				<Property Name="Length" Value="2185" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/4/2014&#xD;&#xA;-- Description:&#x9;Deletes Issue and all associated with it records.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Issue_Del]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = Issue_Del @ID=254319&#x9;--, @UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Issue_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

----------------- Checks 
select @Title = nullif(@Title, '')
if @Title is NOT NULL
	select @Title = '%' + ltrim(rtrim(@Title)) + '%'
	
if @PublicationID is NOT NULL and not exists(select * from Publication (nolock) where ID = @PublicationID) begin
	raiserror('Issue_GetList:: Publication record with ID=%i does not exist.', 16, 1, @PublicationID)
	RETURN -1
end

if @ChiefEditorID is NOT NULL 
	select @ChiefEditorID = ID from Reviewer (nolock) where ID = @ChiefEditorID
else if @ChiefEditorUserID is NOT NULL
	select @ChiefEditorID = ID from Reviewer (nolock) where UserId = @ChiefEditorUserID
else
	select @ChiefEditorID = ID from Reviewer (nolock) where Name = @ChiefEditorName
----------------- Checks 

; with 
st_a as (
	select IssueID = i.IssueID,
		Cnt = count(*),
		Cnt_Published = sum(case when a.WF_StatusID > 99 then 1 else 0 end)
	from Issue_Article i (nolock)
		join Article a (nolock) on i.ArticleID = a.ID
	group by i.IssueID
),
st_tn as (
	select IssueID = i.IssueID,
		Cnt = count(*),
		Cnt_Published = sum(case when tn.WF_StatusID > 99 then 1 else 0 end)
	from Issue_TasteNote i (nolock)
		join TasteNote tn (nolock) on i.TasteNoteID = tn.ID
	group by i.IssueID
),
st_te as (
	select IssueID = i.IssueID,
		Cnt = count(*),
		Cnt_Published = sum(case when te.WF_StatusID > 99 then 1 else 0 end)
	from Issue_TastingEvent i (nolock)
		join TastingEvent te (nolock) on i.TastingEventID = te.ID
	group by i.IssueID
)
select 
	ID = i.ID,
	PublicationID = i.PublicationID,
	PublicationName = p.Name,
	ChiefEditorID = i.ChiefEditorID,
	ChiefEditorName = isnull(r.Name, ''),
	Title = i.Title,
	CreatedDate = i.CreatedDate,
	PublicationDate = i.PublicationDate,
	Notes = i.Notes, 

	created = i.created, 
	updated = i.updated,
	
	Cnt_Articles = isnull(st_a.Cnt, 0),
	Cnt_ArticlesPublished = isnull(st_a.Cnt_Published, 0),
	Cnt_TasteNotes = isnull(st_tn.Cnt, 0),
	Cnt_TasteNotesPublished = isnull(st_tn.Cnt_Published, 0),
	Cnt_TastingEvents = isnull(st_te.Cnt, 0),
	Cnt_TastingEventsPublished = isnull(st_te.Cnt_Published, 0)	
from Issue i (nolock)
	join Publication p (nolock) on i.PublicationID = p.ID
	left join st_a on i.ID = st_a.IssueID
	left join st_tn on i.ID = st_tn.IssueID
	left join st_te on i.ID = st_te.IssueID
	left join Reviewer r (nolock) on i.ChiefEditorID = r.ID
where i.ID = isnull(@ID, i.ID)
	and (@PublicationID is NULL or i.PublicationID = @PublicationID)
	and (@ChiefEditorID is NULL or i.ChiefEditorID = @ChiefEditorID)
	and (@CreatedDate is NULL or i.CreatedDate = @CreatedDate)
	and (@PublicationDate is NULL or i.PublicationDate = @PublicationDate)
	and (@Title is NULL or i.Title like @Title)
order by i.PublicationDate desc, i.ID
	
RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@ChiefEditorUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@ChiefEditorName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article].[ArticleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Article].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Article].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Article].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_GetList].[@PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Title]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Issue_GetList].[CTE1].[st_a]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_a].[IssueID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Issue_Article].[IssueID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_a].[Cnt]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_a].[Cnt_Published]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Issue_GetList].[CTE1].[st_tn]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_tn].[IssueID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_tn].[Cnt]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_tn].[Cnt_Published]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Issue_GetList].[CTE1].[st_te]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_te].[IssueID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_te].[Cnt]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Issue_GetList].[CTE1].[st_te].[Cnt_Published]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@PublicationID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@ChiefEditorID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@ChiefEditorUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@ChiefEditorName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@Title]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@CreatedDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@PublicationDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="231" />
				<Property Name="Length" Value="3362" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/4/2014&#xD;&#xA;-- Description:&#x9;Gets List of Issues.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Input parameters are used as a filter.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Issue_GetList]&#xD;&#xA;&#x9;@ID int = NULL, &#xD;&#xA;&#x9;@PublicationID int = NULL,&#xD;&#xA;&#x9;@ChiefEditorID int = NULL, @ChiefEditorUserID int = NULL, @ChiefEditorName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Title nvarchar(255) = NULL,&#xD;&#xA;&#x9;@CreatedDate date = NULL, @PublicationDate date = NULL,&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;exec Issue_GetList @PublicationID = 1&#xD;&#xA;*/&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Issue_TasteNote]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[IssueID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[TasteNoteID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="37" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[oldArticleIdNKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[oldArticleId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[oldArticleClumpName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TasteNote].[oldPages]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="142" />
			<AttachedAnnotation Disambiguator="99" />
			<AttachedAnnotation Disambiguator="100" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Issue_TastingEvent]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TastingEvent].[IssueID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TastingEvent].[TastingEventID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Issue_TastingEvent].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="38" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="143" />
			<AttachedAnnotation Disambiguator="101" />
			<AttachedAnnotation Disambiguator="102" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Issue_Update]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@EditorID int

------------ Checks
if @PublicationID is NOT NULL and not exists(select * from Publication (nolock) where ID = @PublicationID) begin
	raiserror('Issue_Update:: Publication record with ID=%i does not exist.', 16, 1, @PublicationID)
	RETURN -1
end

if @ChiefEditorID is NOT NULL 
	select @ChiefEditorID = ID from Reviewer (nolock) where ID = @ChiefEditorID
else if @ChiefEditorUserID is NOT NULL
	select @ChiefEditorID = ID from Reviewer (nolock) where UserId = @ChiefEditorUserID
else
	select @ChiefEditorID = ID from Reviewer (nolock) where Name = @ChiefEditorName

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('Issue_Update:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION
	
	update Issue set 
		PublicationID = isnull(@PublicationID, PublicationID), 
		ChiefEditorID = isnull(@ChiefEditorID, ChiefEditorID), 
		Title = isnull(@Title, Title), 
		CreatedDate = isnull(@CreatedDate, CreatedDate), 
		PublicationDate = isnull(@PublicationDate, PublicationDate), 
		Notes = isnull(@Notes, Notes),
		updated = getdate()
		--EditorID = @EditorID
	where ID = @ID

	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('Issue', @ID)
	--	exec Audit_Add @Type='Success', @Category='Update', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='Issue', @ObjectID=@ID, @Description='Issue updated', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@ChiefEditorUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@ChiefEditorName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ChiefEditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@CreatedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@PublicationDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Issue_Update].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@PublicationID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@ChiefEditorID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@ChiefEditorUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@ChiefEditorName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@Title]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@CreatedDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@PublicationDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@Notes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Issue_Update].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="3151" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/4/2014&#xD;&#xA;-- Description:&#x9;Updates Issue record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Issue_Update]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#x9;@PublicationID int = NULL,&#xD;&#xA;&#x9;@ChiefEditorID int = NULL, @ChiefEditorUserID int = NULL, @ChiefEditorName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Title nvarchar(255) = NULL,&#xD;&#xA;&#x9;@CreatedDate date = NULL, @PublicationDate date = NULL,&#xD;&#xA;&#x9;@Notes nvarchar(max) = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = Issue_Update @ChiefEditorID=2, @Title = 'Test Issue # 1',&#xD;&#xA;&#x9;@CreatedDate = '2/1/2013', @PublicationDate = '2/12/2013',&#xD;&#xA;&#x9;@Notes = 'Just testing...'&#xD;&#xA;select @r&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[dbo].[IX_Audit_IDMapping]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_IDMapping].[ObjectTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_IDMapping].[OldObjectID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_IDMapping]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="32" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[KeywordMap_Wine]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[KeywordMap_Wine].[Source]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[KeywordMap_Wine].[Destination]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="240" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="144" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[KeywordMap_Wine].[IX_KeywordMap_Wine_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[KeywordMap_Wine].[Source]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine].[Destination]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Location_GetLookupID]">
			<Property Name="BodyScript">
				<Value><![CDATA[
set nocount on

declare @Result int
set @ObjectValue = ltrim(rtrim(@ObjectValue))

-- allow 0 values - each lookup table has an entry with ID = 0
if @ObjectValue is NULL or @ObjectValue = ''
	RETURN 0

if (lower(@ObjectName) = 'loccountry') begin
	select @Result = ID from LocationCountry where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into LocationCountry (Name) values (left(@ObjectValue, 25))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'loclocale') begin
	select @Result = ID from LocationLocale where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into LocationLocale (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'loclocation') begin
	select @Result = ID from LocationLocation where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into LocationLocation (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'locregion') begin
	select @Result = ID from LocationRegion where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into LocationRegion (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'locsite') begin
	select @Result = ID from LocationSite where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into LocationSite (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

-- allow 0 values - each lookup table has an entry with ID = 0
--if isnull(@Result, 0) < 1
--	raiserror('Cannot find or create an entry in the [%s] with value "%s".', 16, 1, @ObjectName, @ObjectValue)
	
RETURN isnull(@Result, 0)]]></Value>
			</Property>
			<Property Name="IsQuotedIdentifierOn" Value="False" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Location_GetLookupID].[@ObjectName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Location_GetLookupID].[@ObjectValue]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="302" />
				<Property Name="Length" Value="2737" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/20/14&#xD;&#xA;-- Description:&#x9;Gets internal ID of the lookup record.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;It will automatically add new records into lookup tables, if necessary AND @IsAutoCreate = 1.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Location_GetLookupID]&#xD;&#xA;&#x9;@ObjectName as varchar(30), @ObjectValue as nvarchar(120),&#xD;&#xA;&#x9;@IsAutoCreate bit = 1&#xD;&#xA;&#xD;&#xA;--&#xD;&#xA;-- Gets ID of the lookup record if exists or creates a new entry and returns new ID.&#xD;&#xA;-- Location lookups are essentially cache tables, therefore &quot;cache rules&quot; - auto create - are applied by default.&#xD;&#xA;--&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[LocationCountry]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[Code]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="39" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationCountry].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="40" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="145" />
			<AttachedAnnotation Disambiguator="103" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[LocationCountry].[IX_LocationCountry_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationCountry].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[LocationLocale]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocale].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocale].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocale].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="41" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocale].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocale].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="42" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="146" />
			<AttachedAnnotation Disambiguator="104" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[LocationLocale].[IX_LocationLocale_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationLocale].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[LocationLocation]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocation].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocation].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocation].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="43" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocation].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationLocation].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="44" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="147" />
			<AttachedAnnotation Disambiguator="105" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[LocationLocation].[IX_LocationLocation_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationLocation].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[LocationRegion]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationRegion].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationRegion].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationRegion].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="45" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationRegion].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationRegion].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="46" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="148" />
			<AttachedAnnotation Disambiguator="106" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[LocationRegion].[IX_LocationRegion_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationRegion].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[LocationSite]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationSite].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationSite].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationSite].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="47" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationSite].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[LocationSite].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="48" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="149" />
			<AttachedAnnotation Disambiguator="107" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[LocationSite].[IX_LocationSite_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationSite].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Article]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Article].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Articles]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="10" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="13" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_EntryCategories]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_EntryCategories].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryCategories]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="21" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_EntryMachines]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_EntryMachines].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryMachines]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="23" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_EntrySources]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_EntrySources].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntrySources]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="25" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_EntryTypes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_EntryTypes].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="27" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_EntryUsers]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_EntryUsers].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="29" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_IDMapping]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_IDMapping].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_IDMapping]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="31" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Audit_ObjectTypes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Audit_ObjectTypes].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Audit_ObjectTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[AuditLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="34" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_BottleSize]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineBottleSize].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="150" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Issue]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="140" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Issue_Article]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_Article].[IssueID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_Article].[ArticleID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_Article]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Articles]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="141" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Issue_TasteNote]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_TasteNote].[IssueID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_TasteNote].[TasteNoteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TasteNote]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="142" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Issue_TastingEvent]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_TastingEvent].[IssueID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Issue_TastingEvent].[TastingEventID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Issue_TastingEvent]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="143" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_KeywordMap_Wine]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[KeywordMap_Wine].[Source]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[KeywordMap_Wine]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="144" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_LocationCountry]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationCountry].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="145" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_LocationLocale]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationLocale].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="146" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_LocationLocation]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationLocation].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="147" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_LocationRegion]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationRegion].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="148" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_LocationSite]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[LocationSite].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="149" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Publication]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publication].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="151" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Publication_TasteNote]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publication_TasteNote].[PublicationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publication_TasteNote].[TasteNoteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publication_TasteNote]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="152" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Publisher]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publisher].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Publisher]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="153" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Reviewer]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Reviewer].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="154" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_TasteNote]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TasteNote].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[TasteNotes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="155" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_TastingEvent]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TastingEvent].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[TasteNotes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="156" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_TastingEvent_TasteNote]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="157" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WF]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF].[ObjectTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF].[ObjectID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="158" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WF_ObjectTypes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_ObjectTypes].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="159" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WF_Statuses]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_Statuses].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="160" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WF_Users]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_Users].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="161" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WFHist]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WFHist].[ObjectTypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WFHist].[ObjectID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WFHist].[AssignedDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WFHist]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="162" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Wine_N]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_N].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="163" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Wine_VinN]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="164" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineColor]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineColor].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="165" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineDryness]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineDryness].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="166" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineLabel]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineLabel].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="167" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineMaturity]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineMaturity].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="168" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineProducer]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineProducer].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="169" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineType]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineType].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="170" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineVariety]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineVariety].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="171" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_WineVintage]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineVintage].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="172" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Publication]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication].[PublisherID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="49" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="151" />
			<AttachedAnnotation Disambiguator="108" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Publication].[IX_Publication_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publication].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Publication].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Publication]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Publication_TasteNote]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication_TasteNote].[PublicationID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication_TasteNote].[TasteNoteID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publication_TasteNote].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="50" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="152" />
			<AttachedAnnotation Disambiguator="109" />
			<AttachedAnnotation Disambiguator="110" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Publisher]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publisher].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publisher].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publisher].[IsPrimary]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="52" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publisher].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="51" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Publisher].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="153" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Publisher].[IX_Publisher_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Publisher].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Publisher].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Publisher]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Reviewer]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[UserId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="55" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[oldReviewerIdN]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="54" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="53" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Reviewer].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="56" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="154" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Reviewer].[IX_Reviewer_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Reviewer].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[String2Table]">
			<Property Name="ReturnTableVariable" Value="@Items" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table].[@ItemsStr]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table].[@sepCharacter]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[String2Table].[Item]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[String2Table].[Item]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
begin
	declare 
			@ItemsList nvarchar(4000),
			@Item nvarchar(50), 
			@Pos int
	if datalength(@ItemsStr)<= 4000 --otherwise returns empty table
	begin
		select @ItemsList = LTRIM(RTRIM(cast(@ItemsStr as nvarchar(4000)))) + @sepCharacter
		select @Pos = CHARINDEX(@sepCharacter, @ItemsList, 1)
		if REPLACE(@ItemsList, @sepCharacter, '') <> '' begin
			while @Pos > 0 begin
				select @Item = LTRIM(RTRIM(LEFT(@ItemsList, @Pos - 1)))
				if @Item <> '' begin
					insert into @Items (Item) values (CAST(@Item AS nvarchar(50)))
				end
				select @ItemsList = RIGHT(@ItemsList, LEN(@ItemsList) + case when @sepCharacter = ' ' then 1 else 0 end - @Pos)
				select @Pos = CHARINDEX(@sepCharacter, @ItemsList, 1)
			end
		end	
	end
	return 
end]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="Length" Value="1037" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="CREATE FUNCTION [dbo].[String2Table] &#xD;&#xA;(&#x9;&#xD;&#xA;&#x9;@ItemsStr ntext&#x9;&#x9;&#x9;&#x9;&#x9;-- list of values to be parsed&#xD;&#xA;&#x9;, @sepCharacter char(1) = ','&#x9;-- list separator character&#xD;&#xA;)&#xD;&#xA;--&#xD;&#xA;-- Parses list of comma separated Items into @Items table&#xD;&#xA;--&#xD;&#xA;&#xD;&#xA;RETURNS @Items TABLE (Item nvarchar(50))&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[String2Table].[@ItemsStr]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[ntext]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[String2Table].[@sepCharacter]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[',']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[TasteNote]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[ReviewerID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[Wine_N_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[TastingEventID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[TasteDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[MaturityID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[Rating_Lo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[Rating_Hi]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[DrinkDate_Lo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[DrinkDate_Hi]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[IsBarrelTasting]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="59" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[oldIdn]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[Notes]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="57" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="58" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TasteNote].[OriginID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[TasteNotes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="155" />
			<AttachedAnnotation Disambiguator="111" />
			<AttachedAnnotation Disambiguator="112" />
			<AttachedAnnotation Disambiguator="113" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TasteNote_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

select @OriginID = isnull(@OriginID, 0), @ReviewerID = nullif(@ReviewerID, 0)

------------ Checks
if @OriginID > 0 and not exists(select * from TasteNote (nolock) where ID = @OriginID) begin
	raiserror('TasteNote_Add:: Origin record with ID=%i does not exist.', 16, 1, @OriginID)
	RETURN -1
end

if @ReviewerID is NOT NULL 
	select @ReviewerID = ID from Reviewer (nolock) where ID = @ReviewerID
else if @ReviewerUserID is NOT NULL
	select @ReviewerID = ID from Reviewer (nolock) where UserId = @ReviewerUserID
else
	select @ReviewerID = ID from Reviewer (nolock) where Name = @ReviewerName
if @ReviewerID is NULL begin
	raiserror('TasteNote_Add:: @ReviewerID is required.', 16, 1)
	RETURN -2
end

if not exists(select * from Wine_N (nolock) where ID = @Wine_N_ID) begin
	raiserror('TasteNote_Add:: Wine_N record with ID=%i does not exist.', 16, 1, @Wine_N_ID)
	RETURN -1
end

if not exists(select * from WineMaturity (nolock) where ID = @MaturityID) begin
	raiserror('TasteNote_Add:: WineMaturity record with ID=%i does not exist.', 16, 1, @MaturityID)
	RETURN -1
end
------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TasteNote_Add:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	insert into TasteNote (OriginID, ReviewerID, Wine_N_ID, TasteDate, MaturityID, 
		Rating_Lo, Rating_Hi, DrinkDate_Lo, DrinkDate_Hi, 
		IsBarrelTasting, Notes, --oldPublicationDate,
		created, updated, WF_StatusID)
	values (@OriginID, @ReviewerID, @Wine_N_ID, @TasteDate, @MaturityID, 
		@Rating_Lo, @Rating_Hi, @DrinkDate_Lo, @DrinkDate_Hi, 
		@IsBarrelTasting, @Notes, --@PublicationDate,
		getdate(), null, isnull(@WF_StatusID, 0))
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		select @Result = scope_identity()
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('TasteNote', @Result)
	--	exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='TasteNote', @ObjectID=@Result, @Description='TasteNote added', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@ReviewerUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@ReviewerName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[IsBarrelTasting]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@Rating_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@Rating_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@DrinkDate_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@DrinkDate_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@IsBarrelTasting]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Add].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@OriginID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@ReviewerID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@ReviewerUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@ReviewerName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@Wine_N_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@TasteDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@MaturityID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@Rating_Lo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@Rating_Hi]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@DrinkDate_Lo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@DrinkDate_Hi]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@IsBarrelTasting]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@Notes]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="4123" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/28/2014&#xD;&#xA;-- Description:&#x9;Adds new Taste Note.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TasteNote_Add]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@OriginID int = NULL, -- used to point to the &quot;edited&quot; note...&#xD;&#xA;&#x9;@ReviewerID int = NULL, @ReviewerUserID int = NULL, @ReviewerName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Wine_N_ID int,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@TasteDate date,&#xD;&#xA;&#x9;@MaturityID smallint, &#xD;&#xA;&#x9;@Rating_Lo smallint, @Rating_Hi smallint = NULL,&#xD;&#xA;&#x9;@DrinkDate_Lo date = NULL, @DrinkDate_Hi date = NULL,&#xD;&#xA;&#x9;@IsBarrelTasting bit = 0,&#xD;&#xA;&#xD;&#xA;&#x9;@Notes nvarchar(max),&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;--@PublicationDate date = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;select top 20 * from TasteNote order by ID desc&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TasteNote_Add @OriginID=0, @ReviewerID=2, @Wine_N_ID=6151,&#xD;&#xA;&#x9;@TasteDate = '2/1/2013', @MaturityID = 1,&#xD;&#xA;&#x9;@Rating_Lo = 87, @Rating_Hi = 89, @DrinkDate_Lo='5/1/2015',&#xD;&#xA;&#x9;@Notes = 'First in my list...',&#xD;&#xA;&#x9;@WF_StatusID = NULL&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TasteNote_Del]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int

------------ Checks
if not exists(select * from TasteNote (nolock) where ID = @ID) begin
	raiserror('TasteNote_Del:: Taste Note record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if exists(select * from TasteNote (nolock) where OriginID = @ID) begin
	raiserror('[USERERROR]:: Taste Note cannot be deleted because there are other note record(s) associated with this Taste Note.', 16, 1)
	RETURN -1
end

------------ Audit Log
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Del:: @UserName is required.', 16, 1)
--	RETURN -1
--end
----exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	--declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('TasteNote', @ID)
	
	delete Publication_TasteNote where TasteNoteID = @ID
	delete TastingEvent_TasteNote where TasteNoteID = @ID
	delete TasteNote where ID = @ID
	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	exec Audit_Add @Type='Success', @Category='Delete', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='TasteNote', @ObjectID=@ID, @Description='TasteNote deleted', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Del].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Publication_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Del].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Del].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Del].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="191" />
				<Property Name="Length" Value="2407" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/28/2014&#xD;&#xA;-- Description:&#x9;Deletes TasteNote record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TasteNote_Del]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TasteNote_Del @ID=254319&#x9;--, @UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TasteNote_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

if @ReviewerID is NOT NULL 
	select @ReviewerID = ID from Reviewer (nolock) where ID = @ReviewerID
else if @ReviewerUserID is NOT NULL
	select @ReviewerID = ID from Reviewer (nolock) where UserId = @ReviewerUserID
else
	select @ReviewerID = ID from Reviewer (nolock) where Name = @ReviewerName

if @Wine_N_ID is NOT NULL and not exists(select * from Wine_N (nolock) where ID = @Wine_N_ID) begin
	raiserror('TasteNote_GetList:: Wine_N record with ID=%i does not exist.', 16, 1, @Wine_N_ID)
	RETURN -1
end

	select 
		ID = tn.ID,
		OriginID = tn.OriginID,
		ReviewerID = tn.ReviewerID,
		ReviewerName = r.Name,
		
		Wine_N_ID = tn.Wine_N_ID,
		Wine_ProducerID = w.ProducerID,
		Wine_Producer = w.ProducerToShow,
		Wine_Appellation = w.Appellation,
		Wine_Label = w.Label,
		Wine_Vintage = w.Vintage,
		Wine_Name = w.Name,

		TasteDate = tn.TasteDate, 
		MaturityID = tn.MaturityID, 
		MaturityName = wm.Name,
		MaturitySuggestion = wm.Suggestion,
		Rating_Lo = tn.Rating_Lo, 
		Rating_Hi = tn.Rating_Hi, 
		DrinkDate_Lo = tn.DrinkDate_Lo, 
		DrinkDate_Hi = tn.DrinkDate_Hi, 
		IsBarrelTasting = tn.IsBarrelTasting, 
		Notes = tn.Notes, 
		--PublicationDate = tn.oldPublicationDate,

		WF_StatusID = tn.WF_StatusID,
		WF_StatusName = wfs.Name,
		created = tn.created, 
		updated = tn.updated
	from TasteNote tn (nolock)
		join Reviewer r (nolock) on tn.ReviewerID = r.ID
		join WF_Statuses wfs (nolock) on tn.WF_StatusID = wfs.ID
		join vWineDetails w on tn.Wine_N_ID = w.Wine_N_ID
		join WineMaturity wm (nolock) on tn.MaturityID = wm.ID
	where tn.ID = isnull(@ID, tn.ID)
		and (@ReviewerID is NULL or tn.ReviewerID = @ReviewerID)
		and (@Wine_N_ID is NULL or tn.Wine_N_ID = @Wine_N_ID)
	order by TasteDate desc, ReviewerName, tn.ID
	
RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[TasteNote_GetList].[@ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_GetList].[@ReviewerUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_GetList].[@ReviewerName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_GetList].[@Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ProducerToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Appellation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Vintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity].[Suggestion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[IsBarrelTasting]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@ReviewerID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@ReviewerUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@ReviewerName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@Wine_N_ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="237" />
				<Property Name="Length" Value="2376" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/28/2014&#xD;&#xA;-- Description:&#x9;Gets List of Taste Notes.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Input parameters are used as a filter.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TasteNote_GetList]&#xD;&#xA;&#x9;@ID int = NULL, &#xD;&#xA;&#x9;@ReviewerID int = NULL, @ReviewerUserID int = NULL, @ReviewerName nvarchar(120) = NULL,&#xD;&#xA;&#x9;@Wine_N_ID int = NULL,&#xD;&#xA;&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;exec TasteNote_GetList @ReviewerID = 5&#xD;&#xA;&#xD;&#xA;TODO: add filter by &#xD;&#xA;&#x9;- Publication&#xD;&#xA;&#x9;- Rating&#xD;&#xA;&#x9;- Drink Date&#xD;&#xA;*/&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TasteNote_Update]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@EditorID int,
		@prevWF_StatusID smallint,
		@prevOriginID int

select @ReviewerID = nullif(@ReviewerID, 0)

------------ Checks
select @prevWF_StatusID = WF_StatusID, @prevOriginID = OriginID from TasteNote (nolock) where ID = @ID
if @prevWF_StatusID is NULL begin
	raiserror('TasteNote_Update:: Taste Note record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if isnull(@OriginID, 0) > 0 and not exists(select * from TasteNote (nolock) where ID = @OriginID) begin
	raiserror('TastingEvent_Update:: Origin record with ID=%i does not exist.', 16, 1, @OriginID)
	RETURN -1
end

if @ReviewerID is NOT NULL 
	select @ReviewerID = ID from Reviewer (nolock) where ID = @ReviewerID
else if @ReviewerUserID is NOT NULL
	select @ReviewerID = ID from Reviewer (nolock) where UserId = @ReviewerUserID
else
	select @ReviewerID = ID from Reviewer (nolock) where Name = @ReviewerName

if @Wine_N_ID is NOT NULL and not exists(select * from Wine_N (nolock) where ID = @Wine_N_ID) begin
	raiserror('TastingEvent_Update:: Wine_N record with ID=%i does not exist.', 16, 1, @Wine_N_ID)
	RETURN -1
end

if @MaturityID is NOT NULL and not exists(select * from WineMaturity (nolock) where ID = @MaturityID) begin
	raiserror('TastingEvent_Update:: WineMaturity record with ID=%i does not exist.', 16, 1, @MaturityID)
	RETURN -1
end

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Update:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION
	
	-- if current and new WF status if "published" - silent update
	-- make a copy of the note IF current status is "published" and new status is not "published"
	if @prevWF_StatusID >= 100 and isnull(@WF_StatusID, 0) < 100 begin
		set @WF_StatusID = isnull(@WF_StatusID, 0)
		insert into TasteNote (OriginID, ReviewerID, Wine_N_ID, TasteDate, MaturityID, 
			Rating_Lo, Rating_Hi, DrinkDate_Lo, DrinkDate_Hi, 
			IsBarrelTasting, Notes, --oldPublicationDate,
			created, updated, WF_StatusID)
		select OriginID=@ID, ReviewerID, Wine_N_ID, TasteDate, MaturityID, 
			Rating_Lo, Rating_Hi, DrinkDate_Lo, DrinkDate_Hi, 
			IsBarrelTasting, Notes, --oldPublicationDate,
			created, getdate(), @WF_StatusID
		from TasteNote 
		where ID = @ID
		select @ID = scope_identity()
	end else if @prevWF_StatusID < 100 and isnull(@WF_StatusID, 0) >= 100 and isnull(@prevOriginID, 0) > 0 begin
		-- update "origin" record to status = -100 -- archived.
		update TasteNote set 
			updated = getdate(), 
			WF_StatusID = -100
		where ID = @prevOriginID
	end

	update TasteNote set 
		OriginID = isnull(@OriginID, OriginID), 
		ReviewerID = isnull(@ReviewerID, ReviewerID), 
		Wine_N_ID = isnull(@Wine_N_ID, Wine_N_ID), 
		TasteDate = isnull(@TasteDate, TasteDate), 
		MaturityID = isnull(@MaturityID, MaturityID), 
		Rating_Lo = isnull(@Rating_Lo, Rating_Lo), 
		Rating_Hi = isnull(@Rating_Hi, Rating_Hi), 
		DrinkDate_Lo = isnull(DrinkDate_Lo, DrinkDate_Lo), 
		DrinkDate_Hi = isnull(@DrinkDate_Hi, DrinkDate_Hi), 
		IsBarrelTasting = isnull(@IsBarrelTasting, IsBarrelTasting), 
		Notes = isnull(@Notes, Notes), 
		--oldPublicationDate = isnull(@PublicationDate, oldPublicationDate),
		updated = getdate(), 
		WF_StatusID = isnull(@WF_StatusID, WF_StatusID)
		--EditorID = @EditorID
	where ID = @ID

	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('TasteNote', @ID)
	--	exec Audit_Add @Type='Success', @Category='Update', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='TasteNote', @ObjectID=@ID, @Description='TasteNote updated', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smallint]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@OriginID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@ReviewerUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@ReviewerName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineMaturity].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[MaturityID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Rating_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[DrinkDate_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[IsBarrelTasting]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@Rating_Lo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@Rating_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@DrinkDate_Hi]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@IsBarrelTasting]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote_Update].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@OriginID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@ReviewerID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@ReviewerUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@ReviewerName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@Wine_N_ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@TasteDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@MaturityID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@Rating_Lo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@Rating_Hi]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@DrinkDate_Lo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@DrinkDate_Hi]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@IsBarrelTasting]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@Notes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TasteNote_Update].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="191" />
				<Property Name="Length" Value="5800" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/28/2014&#xD;&#xA;-- Description:&#x9;Updates TasteNote record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TasteNote_Update]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#x9;@OriginID int = NULL, -- used to point to the &quot;edited&quot; note...&#xD;&#xA;&#x9;@ReviewerID int = NULL, @ReviewerUserID int = NULL, @ReviewerName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Wine_N_ID int = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@TasteDate date = NULL,&#xD;&#xA;&#x9;@MaturityID smallint = NULL, &#xD;&#xA;&#x9;@Rating_Lo smallint = NULL, @Rating_Hi smallint = NULL,&#xD;&#xA;&#x9;@DrinkDate_Lo date = NULL, @DrinkDate_Hi date = NULL,&#xD;&#xA;&#x9;@IsBarrelTasting bit = NULL,&#xD;&#xA;&#xD;&#xA;&#x9;@Notes nvarchar(max) = NULL,&#xD;&#xA;&#x9;--@PublicationDate date = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;/*&#xD;&#xA;select top 20 * from TasteNote order by ID desc&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TasteNote_Update @ID = 254320, @OriginID=NULL, @ReviewerID=2, @Wine_N_ID=6151,&#xD;&#xA;&#x9;@TasteDate = '2/1/2013', @MaturityID = 2,&#xD;&#xA;&#x9;@Rating_Lo = 88, @Rating_Hi = 94, @Notes = 'First in my list... and a simple update.',&#xD;&#xA;&#x9;@WF_StatusID = NULL&#xD;&#xA;select @r&#xD;&#xA;&#xD;&#xA;exec TasteNote_Update @ID = 254321, @WF_StatusID = 100&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[TastingEvent]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[ParentID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="61" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[ReviewerID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[Title]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[StartDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[EndDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[Location]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[locCountryID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[locRegionID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[locLocationID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[locLocaleID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[locSiteID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[Notes]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[SortOrder]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="62" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="60" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="64" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[TasteNotes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="156" />
			<AttachedAnnotation Disambiguator="114" />
			<AttachedAnnotation Disambiguator="117" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

select @ParentID = isnull(@ParentID, 0), @ReviewerID = nullif(@ReviewerID, 0)

------------ Checks
if @ParentID > 0 and not exists(select * from TastingEvent (nolock) where ID = @ParentID) begin
	raiserror('TastingEvent_Add:: Parent record with ID=%i does not exist.', 16, 1, @ParentID)
	RETURN -1
end

if @ReviewerID is NOT NULL 
	select @ReviewerID = ID from Reviewer (nolock) where ID = @ReviewerID
else if @ReviewerUserID is NOT NULL
	select @ReviewerID = ID from Reviewer (nolock) where UserId = @ReviewerUserID
else
	select @ReviewerID = ID from Reviewer (nolock) where Name = @ReviewerName
if @ReviewerID is NULL begin
	raiserror('TastingEvent_Add:: @ReviewerID is required.', 16, 1)
	RETURN -2
end

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Add:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

------------ Lookup IDs
declare @locCountryID int, @locRegionID int, @locLocationID int, @locLocaleID int, @locSiteID int
exec @locCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@locCountry, @IsAutoCreate=1
exec @locRegionID = Location_GetLookupID @ObjectName='locRegion', @ObjectValue=@locRegion, @IsAutoCreate=1
exec @locLocationID = Location_GetLookupID @ObjectName='locLocation', @ObjectValue=@locLocation, @IsAutoCreate=1
exec @locLocaleID = Location_GetLookupID @ObjectName='locLocale', @ObjectValue=@locLocale, @IsAutoCreate=1
exec @locSiteID = Location_GetLookupID @ObjectName='locSite', @ObjectValue=@locSite, @IsAutoCreate=1
------------ Lookup IDs

BEGIN TRY
	BEGIN TRANSACTION

	insert into TastingEvent (ParentID, ReviewerID,
		Title, StartDate, EndDate, Location,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		Notes, SortOrder,
		created, updated, WF_StatusID)
	values (@ParentID, @ReviewerID,
		@Title, @StartDate, @EndDate, @Location,
		@locCountryID, @locRegionID, @locLocationID, @locLocaleID, @locSiteID,
		@Notes, isnull(@SortOrder, 0),
		getdate(), null, isnull(@WF_StatusID, 0))
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		select @Result = scope_identity()
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @Result)
	--	exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='WineProducer', @ObjectID=@Result, @Description='WineProducer added', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@ReviewerUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@ReviewerName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Add].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@ParentID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@ReviewerID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@ReviewerUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@ReviewerName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@Title]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@StartDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@Location]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@Notes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@SortOrder]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="4393" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Adds new Tastin Event.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_Add]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@ParentID int = 0, &#xD;&#xA;&#x9;@ReviewerID int = NULL, @ReviewerUserID int = NULL, @ReviewerName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Title nvarchar(255), &#xD;&#xA;&#x9;@StartDate date = NULL, @EndDate date = NULL,&#xD;&#xA;&#xD;&#xA;&#x9;@Location nvarchar(100) = NULL,&#xD;&#xA;&#x9;@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@Notes nvarchar(max) = NULL,&#xD;&#xA;&#x9;@SortOrder smallint = 0,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TastingEvent_Add @ParentID=0, @ReviewerID=2,&#xD;&#xA;&#x9;@Title = 'Test Flight', @StartDate=NULL,&#xD;&#xA;&#x9;@locCountry = 'France',&#xD;&#xA;&#x9;@Notes = 'First in my list...',&#xD;&#xA;&#x9;@WF_StatusID = NULL&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_Del]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int

------------ Checks
if not exists(select * from TastingEvent (nolock) where ID = @ID) begin
	raiserror('TastingEvent_Del:: Tasting Event record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if exists(select * from TastingEvent (nolock) where ParentID = @ID) begin
	raiserror('[USERERROR]:: Tasting Event cannot be deleted because there are sub event record(s) associated with this Event.', 16, 1)
	RETURN -1
end

------------ Audit Log
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Del:: @UserName is required.', 16, 1)
--	RETURN -1
--end
----exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	--declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @ID)
	
	delete TastingEvent_TasteNote where TastingEventID = @ID
	delete TastingEvent where ID = @ID
	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	exec Audit_Add @Type='Success', @Category='Delete', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='WineProducer', @ObjectID=@ID, @Description='WineProducer deleted', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Del].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Del].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Del].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Del].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="196" />
				<Property Name="Length" Value="2382" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Deletes TastingEvent record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_Del]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TastingEvent_Del @ID=2&#x9;--, @UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

select @ParentID = isnull(@ParentID, 0)

if @ID is not null begin
	select 
		ID = te.ID,
		ParentID = te.ParentID,
		ReviewerID = te.ReviewerID,
		ReviewerName = r.Name,
		Title = te.Title,
		StartDate = te.StartDate,
		EndDate = te.EndDate,
		Location = te.Location,
		locCountry = lc.Name,
		locRegion = lr.Name,
		locLocation = lloc.Name,
		locLocale = ll.Name,
		locSite = ls.Name,
		Notes = te.Notes,
		SortOrder = te.SortOrder,
		WF_StatusID = te.WF_StatusID,
		WF_StatusName = wfs.Name,
		created = te.created, 
		updated = te.updated
	from TastingEvent te (nolock)
		join Reviewer r (nolock) on te.ReviewerID = r.ID
		join WF_Statuses wfs (nolock) on te.WF_StatusID = wfs.ID
		left join LocationCountry lc (nolock) on te.locCountryID = lc.ID
		left join LocationRegion lr (nolock) on te.locRegionID = lr.ID
		left join LocationLocation lloc (nolock) on te.locLocationID = lloc.ID
		left join LocationLocale ll (nolock) on te.locLocaleID = ll.ID
		left join LocationSite ls (nolock) on te.locSiteID = ls.ID
	where te.ID > 0 
		and te.ID = @ID
end else begin
	select 
		ID = te.ID,
		ParentID = te.ParentID,
		ReviewerID = te.ReviewerID,
		ReviewerName = r.Name,
		Title = te.Title,
		StartDate = te.StartDate,
		EndDate = te.EndDate,
		Location = te.Location,
		locCountry = lc.Name,
		locRegion = lr.Name,
		locLocation = lloc.Name,
		locLocale = ll.Name,
		locSite = ls.Name,
		Notes = te.Notes,
		SortOrder = te.SortOrder,
		WF_StatusID = te.WF_StatusID,
		WF_StatusName = wfs.Name,
		created = te.created, 
		updated = te.updated
	from TastingEvent te (nolock)
		join Reviewer r (nolock) on te.ReviewerID = r.ID
		join WF_Statuses wfs (nolock) on te.WF_StatusID = wfs.ID
		left join LocationCountry lc (nolock) on te.locCountryID = lc.ID
		left join LocationRegion lr (nolock) on te.locRegionID = lr.ID
		left join LocationLocation lloc (nolock) on te.locLocationID = lloc.ID
		left join LocationLocale ll (nolock) on te.locLocaleID = ll.ID
		left join LocationSite ls (nolock) on te.locSiteID = ls.ID
	where te.ID > 0 
		and te.ParentID = @ParentID
	order by ParentID, StartDate desc, SortOrder
end
	
RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[TastingEvent_GetList].[@ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_GetList].[@ParentID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="331" />
				<Property Name="Length" Value="3068" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Gets List of Tasting Events.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Input parameters are used as a filter.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;If @ParentID is not specified only 1st level events will be showsn (ParentID = 0)&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_GetList]&#xD;&#xA;&#x9;@ID int = NULL, @ParentID int = NULL,&#xD;&#xA;&#x9;--@NameToShow nvarchar(100) = NULL,&#xD;&#xA;&#x9;--@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;--@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;--@StartRow int = NULL, @EndRow int = NULL,&#xD;&#xA;&#x9;--@SortBy varchar(20) = NULL, @SortOrder varchar(3) = NULL&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;exec TastingEvent_GetList &#xD;&#xA;&#x9;, @StartRow = 15, @EndRow = 20, @SortBy = 'NameToShow'&#xD;&#xA;*/&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[TastingEvent_TasteNote]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent_TasteNote].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="63" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="157" />
			<AttachedAnnotation Disambiguator="115" />
			<AttachedAnnotation Disambiguator="116" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_TasteNote_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

declare @sd date, @ed date

		select @sd = StartDate, @ed = isnull(EndDate, dateadd(day, 20, StartDate))
		from TastingEvent (nolock)
		where ID = @TastingEventID

------------ Checks
select @Result = ID, @sd = StartDate, @ed = isnull(EndDate, dateadd(day, 20, StartDate)) 
from TastingEvent (nolock) where ID = @TastingEventID
if @Result is NULL begin
	raiserror('TastingEvent_TasteNote_Add:: Tasting Event record with ID=%i does not exist.', 16, 1, @TastingEventID)
	RETURN -1
end

if not exists(select * from TasteNote (nolock) where ID = @TasteNote) begin
	raiserror('TastingEvent_TasteNote_Add:: Taste Note record with ID=%i does not exist.', 16, 1, @TasteNote)
	RETURN -1
end

if exists(select * from TastingEvent_TasteNote (nolock) where TastingEventID = @TastingEventID and TasteNoteID = @TasteNote) begin
	-- do nothing - linkage already exists
	if @ShowRes = 1
		select Result = 1
	RETURN 1
end

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Add:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	insert into TastingEvent_TasteNote (TastingEventID, TasteNoteID,
		created)
	values (@TastingEventID, @TasteNote,
		getdate())
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		select @Result = 1
		
		update TasteNote set TastingEventID = @TastingEventID
		where ID = @TasteNote and TastingEventID is NULL
			and TasteDate between @sd and @ed
		
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @Result)
	--	exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='WineProducer', @ObjectID=@Result, @Description='WineProducer added', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Add].[@TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Add].[@TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Add].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Add].[@TastingEventID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Add].[@TasteNote]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="208" />
				<Property Name="Length" Value="3156" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Adds new TastingEvent-TasteNote linkage.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_TasteNote_Add]&#xD;&#xA;&#x9;@TastingEventID int, @TasteNote int,&#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;exec TastingEvent_TasteNote_Add&#x9;@TastingEventID=2, @TasteNote=15&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_TasteNote_AddTVP]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

------------ Checks
if exists(select * from @tvpIDList t left join TastingEvent te (nolock) on te.ID = t.LeftID
	where te.ID is NULL) begin
	raiserror('TastingEvent_TasteNote_AddTVP:: Not all Tasting Event ids exist.', 16, 1)
	RETURN -1
end

if exists(select * from @tvpIDList t left join TasteNote tn (nolock) on tn.ID = t.RightID
	where tn.ID is NULL) begin
	raiserror('TastingEvent_TasteNote_AddTVP:: Not all Taste Note ids exist.', 16, 1)
	RETURN -1
end
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	merge TastingEvent_TasteNote as t
	using (
		select LeftID, RightID from @tvpIDList
	) as s 
		on t.TastingEventID = s.LeftID and t.TasteNoteID = s.RightID
	when not matched by target then
		INSERT (TastingEventID, TasteNoteID, created)
		values (s.LeftID, s.RightID, getdate());
	select @Result = @@rowcount

	-- update default TastingEventID in TastingNote if neccessary
	merge TasteNote as t
	using (
		select LeftID, RightID,
			teStartDate = te.StartDate, teEndDate = isnull(te.EndDate, dateadd(day, 20, te.StartDate)),
			TasteDate = tn.TasteDate
		from @tvpIDList t
			join TastingEvent te (nolock) on t.LeftID = te.ID
			join TasteNote tn (nolock) on t.RightID = tn.ID
		where tn.TasteDate between te.StartDate and isnull(te.EndDate, dateadd(day, 20, te.StartDate))
	) as s 
		on t.ID = s.RightID and t.TastingEventID is NULL
	when matched then
		UPDATE set 
			TastingEventID = s.LeftID,
			updated = getdate()
	;
	

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TasteDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList]" Disambiguator="6">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[LeftID]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList].[RightID]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@tvpIDList]">
						<Property Name="IsReadOnly" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References Name="[dbo].[IDLink]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_AddTVP].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="278" />
				<Property Name="Length" Value="2794" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/31/2014&#xD;&#xA;-- Description:&#x9;Adds new TastingEvent-TasteNote linkage - bulk mode.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;LeftID = TastingEventID&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;RightID = TasteNoteID&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_TasteNote_AddTVP]&#xD;&#xA;&#x9;@tvpIDList as dbo.IDLink readonly,&#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @t as dbo.IDLink&#xD;&#xA;insert into @t (LeftID, RightID) &#xD;&#xA;values (2, 2), (2,3), (2,4)&#xD;&#xA;exec TastingEvent_TasteNote_AddTVP @tvpIDList = @t&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_TasteNote_Del]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int

------------ Checks
if not exists(select * from TastingEvent (nolock) where ID = @TastingEventID) begin
	raiserror('TastingEvent_TasteNote_Del:: Tasting Event record with ID=%i does not exist.', 16, 1, @TastingEventID)
	RETURN -1
end

if not exists(select * from TasteNote (nolock) where ID = @TasteNoteID) begin
	raiserror('TastingEvent_TasteNote_Del:: Taste Note record with ID=%i does not exist.', 16, 1, @TasteNoteID)
	RETURN -1
end

------------ Audit Log
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Del:: @UserName is required.', 16, 1)
--	RETURN -1
--end
----exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	--declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @ID)
	
	delete TastingEvent_TasteNote where TastingEventID = @TastingEventID and TasteNoteID = @TasteNoteID
	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		-- remove default Tasting Event if necessary
		update TasteNote set TastingEventID = NULL
		where ID = @TasteNoteID and TastingEventID = @TastingEventID
	
	--	exec Audit_Add @Type='Success', @Category='Delete', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='WineProducer', @ObjectID=@ID, @Description='WineProducer deleted', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Del].[@TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Del].[@TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote].[TasteNoteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[TastingEventID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TasteNote].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Del].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Del].[@TastingEventID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Del].[@TasteNoteID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_TasteNote_Del].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="207" />
				<Property Name="Length" Value="2647" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Deletes TastingEvent-TasteNote linkage.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_TasteNote_Del]&#xD;&#xA;&#x9;@TastingEventID int, @TasteNoteID int,&#xD;&#xA;&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TastingEvent_TasteNote_Del @TastingEventID=1, @TasteNote=2&#x9;--, @UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TastingEvent_Update]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@EditorID int

select @ReviewerID = nullif(@ReviewerID, 0)

------------ Checks
if not exists(select * from TastingEvent (nolock) where ID = @ID) begin
	raiserror('TastingEvent_Update:: Tasting Event record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if @ParentID is not null and not exists(select * from TastingEvent (nolock) where ID = @ParentID) begin
	raiserror('TastingEvent_Update:: Parent record with ID=%i does not exist.', 16, 1, @ParentID)
	RETURN -1
end

if @ReviewerID is NOT NULL 
	select @ReviewerID = ID from Reviewer (nolock) where ID = @ReviewerID
else if @ReviewerUserID is NOT NULL
	select @ReviewerID = ID from Reviewer (nolock) where UserId = @ReviewerUserID
else
	select @ReviewerID = ID from Reviewer (nolock) where Name = @ReviewerName

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('TastingEvent_Update:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

------------ Lookup IDs
declare @locCountryID int, @locRegionID int, @locLocationID int, @locLocaleID int, @locSiteID int
exec @locCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@locCountry, @IsAutoCreate=1
exec @locRegionID = Location_GetLookupID @ObjectName='locRegion', @ObjectValue=@locRegion, @IsAutoCreate=1
exec @locLocationID = Location_GetLookupID @ObjectName='locLocation', @ObjectValue=@locLocation, @IsAutoCreate=1
exec @locLocaleID = Location_GetLookupID @ObjectName='locLocale', @ObjectValue=@locLocale, @IsAutoCreate=1
exec @locSiteID = Location_GetLookupID @ObjectName='locSite', @ObjectValue=@locSite, @IsAutoCreate=1
------------ Lookup IDs

BEGIN TRY
	BEGIN TRANSACTION

	update TastingEvent set
		ParentID = isnull(@ParentID, ParentID), 
		ReviewerID = isnull(@ReviewerID, ReviewerID), 
		Title = isnull(@Title, Title),
		StartDate = isnull(@StartDate, StartDate),
		EndDate = isnull(@EndDate, EndDate),
		Location = isnull(@Location, Location),
		locCountryID = case when @locCountry is NULL then locCountryID else @locCountryID end, 
		locRegionID = case when @locRegion is NULL then locRegionID else @locRegionID end, 
		locLocationID = case when @locLocation is NULL then locLocationID else @locLocationID end, 
		locLocaleID = case when @locLocale is NULL then locLocaleID else @locLocaleID end,  
		locSiteID = case when @locSite is NULL then locSiteID else @locSiteID end, 
		Notes = isnull(@Notes, Notes), 
		SortOrder = isnull(@SortOrder, SortOrder),
		updated = getdate(), 
		WF_StatusID = isnull(@WF_StatusID, WF_StatusID)
		--EditorID = @EditorID
	where ID = @ID

	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	--end else begin
	--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @ID)
	--	exec Audit_Add @Type='Success', @Category='Update', @Source='SQL', @UserName=@UserName, @MachineName='', 
	--		@ObjectType='WineProducer', @ObjectID=@ID, @Description='WineProducer updated', @Message=@msg,
	--		@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ReviewerUserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[UserId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Reviewer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ReviewerName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ParentID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ReviewerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@Title]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@StartDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@Notes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TastingEvent_Update].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ParentID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ReviewerID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ReviewerUserID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ReviewerName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@Title]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@StartDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@Location]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@Notes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@SortOrder]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TastingEvent_Update].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="196" />
				<Property Name="Length" Value="4807" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Updates TastingEvent record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[TastingEvent_Update]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#x9;@ParentID int = NULL, &#xD;&#xA;&#x9;@ReviewerID int = NULL, @ReviewerUserID int = NULL, @ReviewerName nvarchar(120) = NULL, &#xD;&#xA;&#x9;@Title nvarchar(255) = NULL, &#xD;&#xA;&#x9;@StartDate date = NULL, @EndDate date = NULL,&#xD;&#xA;&#xD;&#xA;&#x9;@Location nvarchar(100) = NULL,&#xD;&#xA;&#x9;@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@Notes nvarchar(max) = NULL,&#xD;&#xA;&#x9;@SortOrder smallint = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = TastingEvent_Update&#xD;&#xA;&#x9;@ID = 13, @Title = 'Test Flight with Update',&#xD;&#xA;&#x9;@WF_StatusID = 100&#xD;&#xA;select @r&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlFullTextIndex" Name="[dbo].[vWineDetails]" Disambiguator="5">
			<Property Name="IsStopListOff" Value="True" />
			<Property Name="DoUseSystemStopList" Value="False" />
			<Relationship Name="Catalog">
				<Entry>
					<References Name="[RPOWine_FTSearchWine]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineDetails].[Keywords]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WineIndx]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
			</Relationship>
			<Relationship Name="KeyName">
				<Entry>
					<References Name="[dbo].[vWineDetails].[PK_vWineDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[vWineDetails]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[

	select 
		Wine_N_ID = wn.ID, Wine_VinN_ID = vn.ID, 
		Wine_VinN_GroupID = vn.GroupID,

		Country = lc.Name, Region = lr.Name, Location = ll.Name, 
		Locale = lloc.Name, Site = ls.Name,
		Appellation = coalesce(
			nullif(ls.Name,''), nullif(lloc.name,''), nullif(ll.name,''), nullif(lr.name,''), nullif(lc.name,'')
		),

		Producer = wp.Name, ProducerToShow = wp.NameToShow,
		[Type] = wt.Name, Label = wl.Name,
		Variety = wv.Name, Dryness = wd.Name, Color = wc.Name,
		Vintage = wvin.Name,
		
		Name = rtrim(ltrim(wp.NameToShow + ' ' + wl.Name + ' ' + wv.Name + ' ' + wvin.Name) + case
			when wl.DefaultDrynessID != wd.ID then ' ' + wd.Name
			else ''
		end + case
			when wl.DefaultColorID != wc.ID then ' ' + wc.Name
			else ''
		end),
		
		Keywords = isnull(lc.Name, '') + ' ' + isnull(lr.Name, '') 
			+ ' ' + isnull(ll.Name, '') + ' ' + isnull(lloc.Name, '') + ' ' + isnull(ls.Name,'')
			+ ' ' + isnull(wp.Name, '') + ' ' + isnull(wp.NameToShow, '') 
			+ ' ' + isnull(wt.Name, '') + ' ' + isnull(wl.Name, '')
			+ ' ' + isnull(wv.Name, '') + ' ' + isnull(wd.Name, '') + ' ' + isnull(wc.Name, '')
			+ ' ' + isnull(wvin.Name, ''),
		
		locCountryID = vn.locCountryID, locRegionID = vn.locRegionID,
		locLocationID = vn.locLocationID, locLocaleID = vn.locLocaleID, locSiteID = vn.locSiteID,
		ProducerID = vn.ProducerID, TypeID = vn.TypeID, LabelID = vn.LabelID,
		VarietyID = vn.VarietyID, DrynessID = vn.DrynessID, ColorID = vn.ColorID,
		VintageID = wn.VintageID,
		
		oldIdn = wn.oldIdn, oldEntryN = wn.oldEntryN, 
		oldFixedId = wn.oldFixedId, oldWineNameIdN = wn.oldWineNameIdN,

		Wine_N_WF_StatusID = wn.WF_StatusID
	from dbo.Wine_N wn
		join dbo.Wine_VinN vn on wn.Wine_VinN_ID = vn.ID

		join dbo.WineProducer wp on vn.ProducerID = wp.ID
		join dbo.WineType wt on vn.TypeID = wt.ID
		join dbo.WineLabel wl on vn.LabelID = wl.ID
		join dbo.WineVariety wv on vn.VarietyID = wv.ID
		join dbo.WineDryness wd on vn.DrynessID = wd.ID
		join dbo.WineColor wc on vn.ColorID = wc.ID
		join dbo.WineVintage wvin on wn.VintageID = wvin.ID

		join dbo.LocationCountry lc on vn.locCountryID = lc.ID
		join dbo.LocationRegion lr on vn.locRegionID = lr.ID
		join dbo.LocationLocation ll on vn.locLocationID = ll.ID
		join dbo.LocationLocale lloc on vn.locLocaleID = lloc.ID
		join dbo.LocationSite ls on vn.locSiteID = ls.ID
	--where wn.WF_StatusID > 99]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Wine_N_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Wine_VinN_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Wine_VinN_GroupID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[GroupID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Country]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationCountry].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Region]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationRegion].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Location]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationLocation].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Locale]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationLocale].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Site]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationSite].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Appellation]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Producer]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineProducer].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[ProducerToShow]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineProducer].[NameToShow]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Type]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineType].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Label]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineLabel].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Variety]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineVariety].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Dryness]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineDryness].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Color]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineColor].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Vintage]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineVintage].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Name]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Keywords]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[locCountryID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locCountryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[locRegionID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locRegionID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[locLocationID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[locLocaleID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[locSiteID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locSiteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[ProducerID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ProducerID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[TypeID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[TypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[LabelID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[LabelID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[VarietyID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[VarietyID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[DrynessID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[DrynessID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[ColorID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ColorID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[VintageID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[VintageID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[oldIdn]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[oldIdn]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[oldEntryN]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[oldEntryN]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[oldFixedId]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[oldFixedId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[oldWineNameIdN]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[oldWineNameIdN]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineDetails].[Wine_N_WF_StatusID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_N].[WF_StatusID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultDrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[oldIdn]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[oldEntryN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[oldFixedId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[oldWineNameIdN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="2477" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE VIEW [dbo].[vWineDetails]&#xD;&#xA;WITH SCHEMABINDING&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[vWineDetails].[PK_vWineDetails]">
			<Property Name="IsUnique" Value="True" />
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineDetails].[Wine_N_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WineIndx]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlFullTextIndex" Name="[dbo].[vWineVinNDetails]" Disambiguator="4">
			<Property Name="IsStopListOff" Value="True" />
			<Property Name="DoUseSystemStopList" Value="False" />
			<Relationship Name="Catalog">
				<Entry>
					<References Name="[RPOWine_FTSearchVin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Country]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Region]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Location]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Locale]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Site]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Appellation]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Producer]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[ProducerToShow]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Type]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Label]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Variety]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Dryness]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlFullTextIndexColumnSpecifier">
						<Property Name="LanguageId" Value="1033" />
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Color]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WineIndx]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
			</Relationship>
			<Relationship Name="KeyName">
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[PK_vWineVinNDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[vWineVinNDetails]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="QueryScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[

	select 
		Wine_VinN_ID = vn.ID, 
		Wine_VinN_GroupID = vn.GroupID,

		Country = lc.Name, Region = lr.Name, Location = ll.Name, 
		Locale = lloc.Name, Site = ls.Name,
		Appellation = coalesce(
			nullif(ls.Name,''), nullif(lloc.name,''), nullif(ll.name,''), nullif(lr.name,''), nullif(lc.name,'')
		),

		Producer = wp.Name, ProducerToShow = wp.NameToShow,
		[Type] = wt.Name, Label = wl.Name, 
		Variety = wv.Name, Dryness = wd.Name, Color = wc.Name,
		
		Name = rtrim(ltrim( rtrim(ltrim(wp.NameToShow + ' ' + wl.Name)) + ' ' + wv.Name)),

		locCountryID = vn.locCountryID, locRegionID = vn.locRegionID,
		locLocationID = vn.locLocationID, locLocaleID = vn.locLocaleID, locSiteID = vn.locSiteID,
		ProducerID = vn.ProducerID, TypeID = vn.TypeID, LabelID = vn.LabelID,
		VarietyID = vn.VarietyID, DrynessID = vn.DrynessID, ColorID = vn.ColorID,
		
		Wine_VinN_WF_StatusID = vn.WF_StatusID
	from dbo.Wine_VinN vn

		join dbo.WineProducer wp on vn.ProducerID = wp.ID
		join dbo.WineType wt on vn.TypeID = wt.ID
		join dbo.WineLabel wl on vn.LabelID = wl.ID
		join dbo.WineVariety wv on vn.VarietyID = wv.ID
		join dbo.WineDryness wd on vn.DrynessID = wd.ID
		join dbo.WineColor wc on vn.ColorID = wc.ID

		join dbo.LocationCountry lc on vn.locCountryID = lc.ID
		join dbo.LocationRegion lr on vn.locRegionID = lr.ID
		join dbo.LocationLocation ll on vn.locLocationID = ll.ID
		join dbo.LocationLocale lloc on vn.locLocaleID = lloc.ID
		join dbo.LocationSite ls on vn.locSiteID = ls.ID
	--where vn.WF_StatusID > 99]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Wine_VinN_GroupID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[GroupID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Country]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationCountry].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Region]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationRegion].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Location]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationLocation].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Locale]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationLocale].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Site]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[LocationSite].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Appellation]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Producer]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineProducer].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[ProducerToShow]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineProducer].[NameToShow]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Type]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineType].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Label]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineLabel].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Variety]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineVariety].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Dryness]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineDryness].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Color]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[WineColor].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Name]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[locCountryID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locCountryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[locRegionID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locRegionID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[locLocationID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[locLocaleID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[locSiteID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locSiteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[ProducerID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ProducerID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[TypeID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[TypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[LabelID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[LabelID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[VarietyID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[VarietyID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[DrynessID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[DrynessID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[ColorID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ColorID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[vWineVinNDetails].[Wine_VinN_WF_StatusID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="4" />
				<Property Name="Length" Value="1617" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[vWineVinNDetails]&#xD;&#xA;WITH SCHEMABINDING&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[vWineVinNDetails].[PK_vWineVinNDetails]">
			<Property Name="IsUnique" Value="True" />
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WineIndx]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WF]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[ObjectTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[ObjectID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[AssignedByID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[AssignedToID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[AssignedDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="65" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF].[Note]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="158" />
			<AttachedAnnotation Disambiguator="118" />
			<AttachedAnnotation Disambiguator="119" />
			<AttachedAnnotation Disambiguator="120" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_AddUpdate]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @AssignedByID int, @AssignedToID int

select	@AssignedByLogin = upper(rtrim(@AssignedByLogin)),
		@AssignedToLogin = upper(rtrim(@AssignedToLogin))

if isnull(@ObjectTypeID, 0) < 1 and @ObjectTypeName is NOT NULL
	select @ObjectTypeID = ID from WF_ObjectTypes (nolock) where Name = @ObjectTypeName
if isnull(@ObjectTypeID, 0) < 1 begin
	raiserror('ObjectTypeID cannot be found.', 16, 1)
	RETURN -1
end	

if isnull(@StatusID, 0) < 1 or not exists(select * from WF_Statuses (nolock) where ID = @StatusID) begin
	raiserror('@StatusID cannot be found.', 16, 1)
	RETURN -1
end	

select @AssignedByID = ID from WF_Users (nolock) where Login = @AssignedByLogin
if isnull(@AssignedByID, 0) < 1 begin
	insert into WF_Users (Name, Login) 
	values (@AssignedByName, @AssignedByLogin)
	select @AssignedByID = scope_identity()
end

select @AssignedToID = ID from WF_Users (nolock) where Login = @AssignedToLogin
if isnull(@AssignedToID, 0) < 1 begin
	insert into WF_Users (Name, Login) 
	values (@AssignedToName, @AssignedToLogin)
	select @AssignedToID = scope_identity()
end

--------------------- checks -------------------

; merge WF as t
using (select ObjectTypeID = @ObjectTypeID, ObjectID = @ObjectID) as s
	on t.ObjectTypeID = s.ObjectTypeID and t.ObjectID = s.ObjectID
when matched then
	update set
		StatusID = @StatusID,
		AssignedByID = @AssignedByID,
		AssignedToID = @AssignedToID,
		AssignedDate = getdate(),
		Note = @Note
when not matched then
	insert (ObjectTypeID, ObjectID, StatusID, AssignedByID, AssignedToID, AssignedDate, Note)
	values (s.ObjectTypeID, s.ObjectID, @StatusID, @AssignedByID, @AssignedToID, getdate(), @Note);

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@AssignedByLogin]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@AssignedToLogin]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@ObjectTypeName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@AssignedByName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@AssignedToName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_AddUpdate].[@Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@ObjectTypeID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@ObjectTypeName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@ObjectID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@StatusID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@AssignedByLogin]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@AssignedByName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@AssignedToLogin]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@AssignedToName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_AddUpdate].[@Note]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="203" />
				<Property Name="Length" Value="2232" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Adds or updates a &quot;work flow&quot; record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_AddUpdate]&#xD;&#xA;&#x9;@ObjectTypeID int = NULL, @ObjectTypeName varchar(50) = NULL,&#xD;&#xA;&#x9;@ObjectID int, @StatusID int, &#xD;&#xA;&#x9;@AssignedByLogin varchar(100), @AssignedByName varchar(100) = NULL,&#xD;&#xA;&#x9;@AssignedToLogin varchar(100), @AssignedToName varchar(100) = NULL,&#xD;&#xA;&#x9;@Note varchar(max) = NULL&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_GetHist]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

if isnull(@ObjectTypeID, 0) < 1 and @ObjectTypeName is NOT NULL
	select @ObjectTypeID = ID from WF_ObjectTypes (nolock) where Name = @ObjectTypeName
if isnull(@ObjectTypeID, 0) < 1 begin
	raiserror('ObjectTypeID cannot be found.', 16, 1)
	RETURN -1
end	

select 
	WF_ObjectTypeID = h.ObjectTypeID,
	WF_ObjectID = h.ObjectID,
	WF_AssignedDate = h.AssignedDate,
	WF_StatusID = s.ID,
	WF_StatusName = s.Name,
	WF_AssignedByName = ab.Name,
	WF_AssignedByLogin = ab.Login,
	WF_AssignedToName = at.Name,
	WF_AssignedToLogin = at.Login,
	WF_Note = h.Note
from WF h (nolock)
	join WF_Statuses s (nolock) on h.StatusID = s.ID
	join WF_Users ab (nolock) on h.AssignedByID = ab.ID
	join WF_Users at (nolock) on h.AssignedToID = at.ID
where h.ObjectTypeID = @ObjectTypeID and h.ObjectID = @ObjectID
UNION ALL
select 
	WF_ObjectTypeID = h.ObjectTypeID,
	WF_ObjectID = h.ObjectID,
	WF_AssignedDate = h.AssignedDate,
	WF_StatusID = s.ID,
	WF_StatusName = s.Name,
	WF_AssignedByName = ab.Name,
	WF_AssignedByLogin = ab.Login,
	WF_AssignedToName = at.Name,
	WF_AssignedToLogin = at.Login,
	WF_Note = h.Note
from WFHist h (nolock)
	join WF_Statuses s (nolock) on h.StatusID = s.ID
	join WF_Users ab (nolock) on h.AssignedByID = ab.ID
	join WF_Users at (nolock) on h.AssignedToID = at.ID
where h.ObjectTypeID = @ObjectTypeID and h.ObjectID = @ObjectID
order by h.AssignedDate desc

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WF_GetHist].[@ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetHist].[@ObjectTypeName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetHist].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetHist].[@ObjectTypeID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetHist].[@ObjectTypeName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetHist].[@ObjectID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="235" />
				<Property Name="Length" Value="1790" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Gets list of WF changes associated with a particular object instance.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_GetHist]&#xD;&#xA;&#x9;@ObjectTypeID int = NULL, @ObjectTypeName varchar(50) = NULL,&#xD;&#xA;&#x9;@ObjectID int&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_GetStats]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @AssignedByID int, @AssignedToID int

select	@AssignedByLogin = upper(rtrim(@AssignedByLogin)),
		@AssignedToLogin = upper(rtrim(@AssignedToLogin))

if isnull(@ObjectTypeID, 0) < 1 and @ObjectTypeName is NOT NULL
	select @ObjectTypeID = ID from WF_ObjectTypes (nolock) where Name = @ObjectTypeName
if isnull(@StatusID, 0) < 1 and @StatusName is NOT NULL
	select @StatusID = ID from WF_Statuses (nolock) where Name = @StatusName

if @AssignedByLogin is NOT NULL begin
	select @AssignedByID = ID from WF_Users (nolock) where Login = @AssignedByLogin
	if @AssignedByID is NULL
		RETURN 0
end
if @AssignedToLogin is NOT NULL begin
	select @AssignedToID = ID from WF_Users (nolock) where Login = @AssignedToLogin
	if @AssignedToID is NULL
		RETURN 0
end

-----------------------------------------------------------------------

; with r as (
	select ObjectTypeID, StatusID, AssignedByID, AssignedToID, NumberOfObjects = count(*)
	from WF wf (nolock) 
	where (@ObjectTypeID is NULL or wf.ObjectTypeID = @ObjectTypeID)
		and (@StatusID is NULL or wf.StatusID = @StatusID)
		and (@AssignedByID is NULL or wf.AssignedByID = @AssignedByID)
		and (@AssignedToID is NULL or wf.AssignedToID = @AssignedToID)
	group by ObjectTypeID, StatusID, AssignedByID, AssignedToID
)
select
	WF_ObjectTypeID = stat.ObjectTypeID,
	WF_ObjectTypeName = isnull(ot.Name, 'TOTAL'),
	WF_StatusID = stat.StatusID,
	WF_StatusName = case 
		when stat.StatusID = -1 then 'Unassigned' 
		else isnull(s.Name, 'TOTAL') 
	end,
	WF_AssignedToName = case
		when s.Name is NULL and ut.Name is NULL then ''
		else isnull(ut.Name, 'TOTAL')
	end,
	WF_AssignedToLogin = isnull(ut.Login, ''),
	WF_NumberOfObject = NumberOfObjects
from (
	select wf.ObjectTypeID, wf.StatusID, wf.AssignedToID,
		NumberOfObjects = sum(NumberOfObjects)
	from r wf
	group by wf.ObjectTypeID, wf.StatusID, wf.AssignedToID
	with rollup
	) stat
	join WF_ObjectTypes ot on stat.ObjectTypeID = ot.ID
	left join WF_Statuses s (nolock) on stat.StatusID = s.ID	
	left join WF_Users ut (nolock) on stat.AssignedToID = ut.ID	
--order by WF_ObjectTypeName, WF_Status, WF_AssignedByLogin, WF_AssignedToLogin

drop table #t

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@AssignedByLogin]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@AssignedToLogin]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@ObjectTypeName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_GetStats].[@StatusName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry />
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WF_GetStats].[CTE1].[r]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WF_GetStats].[CTE1].[r].[ObjectTypeID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF].[ObjectTypeID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WF_GetStats].[CTE1].[r].[StatusID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF].[StatusID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WF_GetStats].[CTE1].[r].[AssignedByID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF].[AssignedByID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WF_GetStats].[CTE1].[r].[AssignedToID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF].[AssignedToID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WF_GetStats].[CTE1].[r].[NumberOfObjects]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@ObjectTypeID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@ObjectTypeName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@StatusName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@AssignedByLogin]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@AssignedByName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@AssignedToLogin]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_GetStats].[@AssignedToName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="209" />
				<Property Name="Length" Value="2762" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Gets basic statistic of the WF assignments.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_GetStats]&#xD;&#xA;&#x9;@ObjectTypeID int = NULL, @ObjectTypeName varchar(50) = NULL,&#xD;&#xA;&#x9;@StatusID int = NULL, @StatusName varchar(50) = NULL,&#xD;&#xA;&#x9;@AssignedByLogin varchar(100) = NULL, @AssignedByName varchar(100) = NULL,&#xD;&#xA;&#x9;@AssignedToLogin varchar(100) = NULL, @AssignedToName varchar(100) = NULL&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WF_ObjectTypes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_ObjectTypes].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_ObjectTypes].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_ObjectTypes].[DateOp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="66" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="159" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WF_ObjectTypes].[WF_ObjectTyoes_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_ObjectTypes].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_ObjectTypes_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

select	
		ID,
		Name
from WF_ObjectTypes (nolock)
order by Name

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="203" />
				<Property Name="Length" Value="355" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Gets List of registered Object Types.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_ObjectTypes_GetList]&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlDmlTrigger" Name="[dbo].[WF_OnUpdate]">
			<Property Name="IsUpdateTrigger" Value="True" />
			<Property Name="SqlTriggerType" Value="1" />
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[ 
BEGIN
	SET NOCOUNT ON;

	declare @ObjID int, @ObjTypeID int, @DT datetime
	select @ObjID=ObjectID, @ObjTypeID=ObjectTypeID, @DT = AssignedDate from deleted 
	
	if exists(select * from deleted d 
		left join (select * from inserted) f 
			on d.StatusID = f.StatusID and d.AssignedByID = f.AssignedByID and d.AssignedToID = f.AssignedToID
				and isnull(d.Note, '') = isnull(f.Note, '')
		where f.StatusID is NULL) begin

		if exists(select * from WFHist where @ObjID=ObjectID and @ObjTypeID=ObjectTypeID and @DT = AssignedDate)
			select @DT = dateadd(ms,1,@DT)
		insert into WFHist (ObjectTypeID, ObjectID, StatusID, AssignedByID, AssignedToID, AssignedDate, Note)
		select d.ObjectTypeID, d.ObjectID, d.StatusID, d.AssignedByID, d.AssignedToID, @DT, d.Note
		from deleted d

	end

  --  if update(StatusID) or update(AssignedByID) or update(AssignedToID) begin
		--insert into WFHist (ObjectTypeID, ObjectID, StatusID, AssignedByID, AssignedToID, AssignedDate, Note)
		--select d.ObjectTypeID, d.ObjectID, d.StatusID, d.AssignedByID, d.AssignedToID, d.AssignedDate, d.Note
		--from deleted d
  --  end

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[AssignedDate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WFHist].[Note]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectTypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedByID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[AssignedToID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF].[Note]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parent">
				<Entry>
					<References Name="[dbo].[WF]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Offset" Value="811" />
				<Property Name="Length" Value="1199" />
				<Property Name="StartLine" Value="17" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE TRIGGER [dbo].[WF_OnUpdate] ON [dbo].[WF] FOR UPDATE&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WF_Statuses]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Statuses].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Statuses].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Statuses].[SortOrder]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="68" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Statuses].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="67" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="160" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WF_Statuses].[IX_WF_Statuses_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_Statuses].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_Statuses_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

select	
		ID,
		Name
from WF_Statuses (nolock)
order by SortOrder, Name

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[SortOrder]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_Statuses_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="206" />
				<Property Name="Length" Value="387" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Gets List of registered Object Statuses.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_Statuses_GetList]&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WF_Users]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Users].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Users].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Users].[Login]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Users].[DateOp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="69" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WF_Users].[IsAvailable]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="70" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="161" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WF_Users].[WF_Users_UniqLogin]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WF_Users].[Login]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WF_Users_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

if @ID is NOT NULL begin
	select 	
		ID, 
		Name,
		Login
	from WF_Users (nolock)
	where ID = @ID
	order by Name
end else begin
	select 	
		ID, 
		Name,
		Login
	from WF_Users (nolock)
	where IsAvailable = 1
	order by Name
end

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WF_Users_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Users].[IsAvailable]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_Users_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_Users_GetList].[@Name]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_Users_GetList].[@Login]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WF_Users_GetList].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="210" />
				<Property Name="Length" Value="630" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 2/04/2014&#xD;&#xA;-- Description:&#x9;Gets List of registered and available Users.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WF_Users_GetList]&#xD;&#xA;&#x9;@ID int = NULL,&#xD;&#xA;&#x9;@Name varchar(256) = NULL, @Login varchar(256) = NULL,&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WFHist]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[ObjectTypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[ObjectID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[AssignedByID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[AssignedToID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[AssignedDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WFHist].[Note]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FilegroupForTextImage">
				<Entry>
					<References Name="[WF]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="162" />
			<AttachedAnnotation Disambiguator="121" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Wine_GetID]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int,
		@Wine_VinN_ID int

------------ Checks
if @IsAutoCreate = 1 and (len(isnull(@Vintage, '')) < 1)
begin
	select @Result = -1
	raiserror('Wine_GetID:: Cannot find or register a new Wine: vintage is required.', 16, 1)
	RETURN -1
end
------------ Checks

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('WineVin_GetID:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName

exec @Wine_VinN_ID = WineVin_GetID	
	@Producer=@Producer, @WineType=@WineType, @Label=@Label, @Variety=@Variety, @Dryness=@Dryness, @Color=@Color,
	@locCountry=@locCountry, @locRegion=@locRegion, @locLocation=@locLocation, @locLocale=@locLocale, @locSite=@locSite,
	@WF_StatusID = @WF_StatusID,
	--@UserName = @UserName,
	@IsAutoCreate = @IsAutoCreate,
	@ShowRes = 0
if @Wine_VinN_ID < 1 begin
	select @Result = @Wine_VinN_ID
	raiserror('Wine_GetID:: Cannot find or register a new WineVin.', 16, 1)
	if @ShowRes = 1
		select Result = isnull(@Result, -1)
	RETURN isnull(@Result, -1)
end

BEGIN TRY
	BEGIN TRANSACTION

	------------ Lookup IDs
	declare @VintageID int
	exec @VintageID = Wine_GetLookupID @ObjectName='winevintage', @ObjectValue=@Vintage, @IsAutoCreate=@IsAutoCreate
	------------ Lookup IDs

	------------ Checks
	if @VintageID < 1 begin
		select @Result = -1
		raiserror('Wine_GetID:: Cannot find or register a new Wine: vintage is required.', 16, 1)
	end
	------------ Checks

	-- this is a unique key therefore only 1 record can be returned
	select @Result = ID from Wine_N
	where Wine_VinN_ID = @Wine_VinN_ID and VintageID = @VintageID
	if @Result is NULL begin
		insert into Wine_N (Wine_VinN_ID, VintageID,
			created, updated, WF_StatusID)
		values (@Wine_VinN_ID, @VintageID,
            getdate(), null, isnull(@WF_StatusID, 0))
		if @@error <> 0 begin
			select @Result = -1
			ROLLBACK TRAN
		end else begin
			select @Result = scope_identity()
		--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('Wine_N', @Result)
		--	exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
		--		@ObjectType='Wine_N', @ObjectID=@Result, @Description='Wine_N added', @Message=@msg,
		--		@ShowRes=0
		end
	end
	
	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Vintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Producer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Producer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Variety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Variety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Dryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Dryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Color]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@Color]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetID].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Producer]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@WineType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Label]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Variety]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Dryness]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Color]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@Vintage]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@IsAutoCreate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetID].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="325" />
				<Property Name="Length" Value="4344" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/31/2014&#xD;&#xA;-- Description:&#x9;Searches for a Wine (Wine_N) and returns internal ID of the wine.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;If a particular Wine_N record cannot be found, it will be created and new ID returned.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Wine_GetID]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@Producer nvarchar(100), @WineType nvarchar(50), @Label nvarchar(120),&#xD;&#xA;&#x9;@Variety nvarchar(50), @Dryness nvarchar(30), @Color nvarchar(30),&#xD;&#xA;&#x9;@Vintage nvarchar(4),&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@locCountry nvarchar(25) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@IsAutoCreate bit = 1,&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = Wine_GetID @Producer = 'Gerard Depardieu', @WineType = 'Table', @Label = 'Domaine de St. Augustin',&#xD;&#xA;&#x9;@Variety = 'Proprietary Blend', @Dryness = 'Dry', @Color = 'Red',&#xD;&#xA;&#x9;@Vintage = '2002',&#xD;&#xA;&#x9;@locCountry = 'Algeria', @locRegion = 'Coteaux de Tlemcen', &#xD;&#xA;&#x9;@locLocation = 'a', @locLocale = NULL, @locSite = NULL,&#xD;&#xA;&#x9;@WF_StatusID = NULL, @IsAutoCreate = 0&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Wine_GetList_ByVinID]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

select 
	Wine_N_ID = w.ID,
	Wine_VinN_ID = w.Wine_VinN_ID,
	VintageID = w.VintageID,
	Vintage = wv.Name,
	Wine_V_WF_StatusID = w.WF_StatusID
from Wine_N w (nolock)
	join WineVintage wv (nolock) on w.VintageID = wv.ID
where w.Wine_VinN_ID = @Wine_VinN_ID
order by Vintage

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetList_ByVinID].[@Wine_VinN_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetList_ByVinID].[@Wine_VinN_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="222" />
				<Property Name="Length" Value="596" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/19/2014&#xD;&#xA;-- Description:&#x9;Gets list of all Vintages available for a specified VinID&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE Wine_GetList_ByVinID&#xD;&#xA;&#x9;@Wine_VinN_ID int&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Wine_GetLookupID]">
			<Property Name="BodyScript">
				<Value><![CDATA[
set nocount on

declare @Result int
set @ObjectValue = ltrim(rtrim(@ObjectValue))

--------------- simple 
if (lower(@ObjectName) = 'winebottlesize') begin
	select @Result = ID from WineBottleSize where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineBottleSize (Name) values (left(@ObjectValue, 30))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winecolor') begin
	select @Result = ID from WineColor where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineColor (Name) values (left(@ObjectValue, 30))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winedryness') begin
	select @Result = ID from WineDryness where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineDryness (Name) values (left(@ObjectValue, 30))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winelabel') begin
	select @Result = ID from WineLabel where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineLabel (Name) values (left(@ObjectValue, 120))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winetype') begin
	select @Result = ID from WineType where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineType (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winevariety') begin
	select @Result = ID from WineVariety where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineVariety (Name) values (left(@ObjectValue, 50))
		select @Result = scope_identity()
	end
end

if (lower(@ObjectName) = 'winevintage') begin
	select @Result = ID from WineVintage where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineVintage (Name) values (left(@ObjectValue, 4))
		select @Result = scope_identity()
	end
end

------------- complex
if (lower(@ObjectName) = 'wineproducer') begin
	select @Result = ID from WineProducer where lower(Name) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1
		select @Result = ID from WineProducer where lower(NameToShow) = lower(@ObjectValue)
	if isnull(@Result, 0) < 1 and @IsAutoCreate = 1 and len(@ObjectValue) > 0 begin
		insert into WineProducer (Name, NameToShow) values (left(@ObjectValue, 100), left(@ObjectValue, 100))
		select @Result = scope_identity()
	end
end

if isnull(@Result, 0) < 1
	raiserror('Cannot find or create an entry in the [%s] with value "%s".', 16, 1, @ObjectName, @ObjectValue)
	
RETURN isnull(@Result, 0)]]></Value>
			</Property>
			<Property Name="IsQuotedIdentifierOn" Value="False" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineBottleSize].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineBottleSize].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetLookupID].[@ObjectName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetLookupID].[@ObjectValue]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_GetLookupID].[@IsAutoCreate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="302" />
				<Property Name="Length" Value="3679" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/22/14&#xD;&#xA;-- Description:&#x9;Gets internal ID of the lookup record.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;It will automatically add new records into lookup tables, if necessary AND @IsAutoCreate = 1.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[Wine_GetLookupID]&#xD;&#xA;&#x9;@ObjectName as varchar(30), @ObjectValue as nvarchar(120),&#xD;&#xA;&#x9;@IsAutoCreate bit = 1&#xD;&#xA;&#xD;&#xA;--&#xD;&#xA;-- Gets ID of the lookup record if exists or creates a new entry and returns new ID.&#xD;&#xA;-- Wine lookups are essentially cache tables, therefore &quot;cache rules&quot; - auto create - are applied by default.&#xD;&#xA;--&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Wine_N]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[Wine_VinN_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[VintageID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[oldIdn]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[oldEntryN]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[oldFixedId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[oldWineNameIdN]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="71" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_N].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="72" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="163" />
			<AttachedAnnotation Disambiguator="122" />
			<AttachedAnnotation Disambiguator="123" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_N].[IX_Wine_N_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_N].[Wine_VinN_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_N].[VintageID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_N].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_N].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_N]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Wine_SearchFT]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET NUMERIC_ROUNDABORT OFF

select @SearchString = replace(replace(rtrim(ltrim(@SearchString)), '%', '*'), '  ', ' ')

-- applying macroses
select @SearchString = dbo.fn_GetAdjustedSearchString(@SearchString)

if @isDebug = 1
	print @SearchString

--------- Results --------
select -- top(@topNRows) -->> cannot use here because of sorting
	Wine_N_ID, Wine_VinN_ID, Wine_VinN_GroupID,
	locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
	ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,	VintageID
into #t
from vWineDetails where contains(*, @SearchString)

if @@rowcount > 100 begin
	if @isDebug = 1
		print '--- Creating Index on #t ---'
	CREATE NONCLUSTERED INDEX [IX_t] ON #t (
		[ColorID] ASC
	) WITH (SORT_IN_TEMPDB = ON);
end

--; with r as (
--	select WineN_ID, 
--		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
--		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,	VintageID
--	from vWineDetails where contains(*, @SearchString)
--)
select top(@topNRows)
	Wine_N_ID = r.Wine_N_ID,
	Wine_VinN_ID = r.Wine_VinN_ID, 
	Wine_VinN_GroupID = r.Wine_VinN_GroupID,
	Country = lc.Name, Region = lr.Name, Location = ll.Name, 
	Locale = lloc.Name, Site = ls.Name,
	Producer = wp.Name, ProducerToShow = wp.NameToShow,
	[Type] = wt.Name, Label = wl.Name,
	Variety = wv.Name, Dryness = wd.Name, Color = wc.Name,
	Vintage = wvin.Name
from #t r
	join dbo.LocationCountry lc (nolock) on r.locCountryID = lc.ID
	join dbo.LocationRegion lr (nolock) on r.locRegionID = lr.ID
	join dbo.LocationLocation ll (nolock) on r.locLocationID = ll.ID
	join dbo.LocationLocale lloc (nolock) on r.locLocaleID = lloc.ID
	join dbo.LocationSite ls (nolock) on r.locSiteID = ls.ID

	join dbo.WineProducer wp (nolock) on r.ProducerID = wp.ID
	join dbo.WineType wt (nolock) on r.TypeID = wt.ID
	join dbo.WineLabel wl (nolock) on r.LabelID = wl.ID
	join dbo.WineVariety wv (nolock) on r.VarietyID = wv.ID
	join dbo.WineDryness wd (nolock) on r.DrynessID = wd.ID
	join dbo.WineColor wc (nolock) on r.ColorID = wc.ID
	join dbo.WineVintage wvin (nolock) on r.VintageID = wvin.ID
order by Country, Producer, Type, Label, Vintage

drop table #t

/*
-- CONTAINSTABLE
declare @SS nvarchar(400) = replace(replace(replace(@SearchString, ' AND ', ''), ' OR ', ''), ' ', ' AND ')
select v.* , fts.RANK
from vWineDetails v
	join CONTAINSTABLE(vWineDetails, 
		(Producer,WineType,LabelName,Variety,Dryness,ColorClass,Country,Region,Location,Locale,Site), 
		@SS, @topNRows) fts
	on v.VinN_ID = fts.[KEY]
where fts.RANK > @rankLimit
order by fts.RANK desc

-- FREETEXTTABLE
select v.* , fts.RANK
from vWineDetails v
	join FREETEXTTABLE(vWineDetails, 
		(Producer,WineType,LabelName,Variety,Dryness,ColorClass,Country,Region,Location,Locale,Site), 
		@SearchString, @topNRows) fts
	on v.VinN_ID = fts.[KEY]
where fts.RANK > @rankLimit
order by fts.RANK desc
*/

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[@SearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[@isDebug]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Wine_VinN_GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[VintageID]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[VintageID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[@topNRows]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[Wine_N_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_SearchFT].[#t].[Wine_VinN_GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVintage].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Wine_SearchFT].[#t]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[Wine_N_ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Wine_N_ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[Wine_VinN_ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Wine_VinN_ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[Wine_VinN_GroupID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Wine_VinN_GroupID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[locCountryID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[locCountryID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[locRegionID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[locRegionID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[locLocationID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[locLocationID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[locLocaleID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[locLocaleID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[locSiteID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[locSiteID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[ProducerID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[ProducerID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[TypeID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[TypeID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[LabelID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[LabelID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[VarietyID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[VarietyID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[DrynessID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[DrynessID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[ColorID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[ColorID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Wine_SearchFT].[#t].[VintageID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[VintageID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_SearchFT].[@SearchString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_SearchFT].[@topNRows]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[30]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Wine_SearchFT].[@isDebug]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3261" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[Wine_SearchFT]&#xD;&#xA;&#x9;@SearchString nvarchar(1024), &#xD;&#xA;&#x9;@topNRows int = 30, --@rankLimit int = 20,&#xD;&#xA;&#x9;@isDebug bit = 0&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Wine_VinN]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[GroupID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="74" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[ProducerID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[TypeID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[LabelID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[VarietyID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[DrynessID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[ColorID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[locCountryID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[locRegionID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[locLocationID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[locLocaleID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[locSiteID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="73" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Wine_VinN].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="75" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="164" />
			<AttachedAnnotation Disambiguator="124" />
			<AttachedAnnotation Disambiguator="125" />
			<AttachedAnnotation Disambiguator="126" />
			<AttachedAnnotation Disambiguator="127" />
			<AttachedAnnotation Disambiguator="128" />
			<AttachedAnnotation Disambiguator="129" />
			<AttachedAnnotation Disambiguator="130" />
			<AttachedAnnotation Disambiguator="131" />
			<AttachedAnnotation Disambiguator="132" />
			<AttachedAnnotation Disambiguator="133" />
			<AttachedAnnotation Disambiguator="134" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_LabelID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[LabelID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_locCountryID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locCountryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_locLocaleID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_locLocationID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_locRegionID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locRegionID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_locSiteID]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locSiteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[Wine_VinN].[IX_Wine_VinN_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ProducerID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[TypeID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[LabelID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[VarietyID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[DrynessID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[ColorID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locCountryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locRegionID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocationID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Wine_VinN].[locSiteID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References Name="[Wine]" />
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineBottleSize]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[Volume]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="77" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="76" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineBottleSize].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="78" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="150" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineBottleSize].[IX_WineBottleSize_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineBottleSize].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineBottleSize].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineBottleSize]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineColor]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineColor].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineColor].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineColor].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="79" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineColor].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineColor].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="80" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="165" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineColor].[IX_WineColor_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineColor].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineDryness]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineDryness].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineDryness].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineDryness].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="81" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineDryness].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineDryness].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="82" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="166" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineDryness].[IX_WineDryness_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineDryness].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineLabel]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="83" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="86" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[DefaultColorID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="84" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineLabel].[DefaultDrynessID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="85" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="167" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineLabel].[IX_WineLabel_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineLabel].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultDrynessID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineMaturity]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineMaturity].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineMaturity].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineMaturity].[Suggestion]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineMaturity].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="87" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineMaturity].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="168" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineMaturity].[IX_WineMaturity_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineMaturity].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineMaturity].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineMaturity]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineProducer]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[NameToShow]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[WebSiteURL]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[locCountryID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[locRegionID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[locLocationID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[locLocaleID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[locSiteID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[Profile]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[ContactInfo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="88" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="89" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[CreatorID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineProducer].[EditorID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="169" />
			<AttachedAnnotation Disambiguator="135" />
			<AttachedAnnotation Disambiguator="136" />
			<AttachedAnnotation Disambiguator="137" />
			<AttachedAnnotation Disambiguator="138" />
			<AttachedAnnotation Disambiguator="139" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineProducer].[IX_WineProducer_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineProducer].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineProducer_Add]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

select @Name = rtrim(ltrim(@Name)), @NameToShow = rtrim(ltrim(isnull(@NameToShow, @Name)))

------------ Checks
if len(isnull(@Name, '')) < 1 begin
	raiserror('WineProducer_Add:: @Name is required.', 16, 1)
	RETURN -1
end

if exists(select * from WineProducer (nolock) where upper(Name) = upper(@Name)) begin
	raiserror('[USERERROR]:: Wine Producer with the same Name already exists.', 16, 1)
	RETURN -1
end

------------ Checks
if len(isnull(@UserName, '')) < 1 begin
	raiserror('WineProducer_Add:: @UserName is required.', 16, 1)
	RETURN -1
end
exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

------------ Lookup IDs
declare @locCountryID int, @locRegionID int, @locLocationID int, @locLocaleID int, @locSiteID int
exec @locCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@locCountry, @IsAutoCreate=1
exec @locRegionID = Location_GetLookupID @ObjectName='locRegion', @ObjectValue=@locRegion, @IsAutoCreate=1
exec @locLocationID = Location_GetLookupID @ObjectName='locLocation', @ObjectValue=@locLocation, @IsAutoCreate=1
exec @locLocaleID = Location_GetLookupID @ObjectName='locLocale', @ObjectValue=@locLocale, @IsAutoCreate=1
exec @locSiteID = Location_GetLookupID @ObjectName='locSite', @ObjectValue=@locSite, @IsAutoCreate=1
------------ Lookup IDs

BEGIN TRY
	BEGIN TRANSACTION

	insert into WineProducer (Name, NameToShow, WebSiteURL,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		[Profile], ContactInfo,
		created, updated, WF_StatusID, CreatorID, EditorID)
	values (@Name, @NameToShow, @WebSiteURL,
		@locCountryID, @locRegionID, @locLocationID, @locLocaleID, @locSiteID,
		@Profile, @ContactInfo,
		getdate(), null, isnull(@WF_StatusID, 0), @CreatorID, null)
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		select @Result = scope_identity()
		declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @Result)
		exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
			@ObjectType='WineProducer', @ObjectID=@Result, @Description='WineProducer added', @Message=@msg,
			@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Profile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ContactInfo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[CreatorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[EditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@Profile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@ContactInfo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Category]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@MachineName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Add].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@NameToShow]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@WebSiteURL]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@Profile]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@ContactInfo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@UserName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Add].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="3901" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/22/2014&#xD;&#xA;-- Description:&#x9;Adds new WineProducer.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineProducer_Add]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@Name nvarchar(100), @NameToShow nvarchar(100),&#xD;&#xA;&#x9;@WebSiteURL nvarchar(255) = NULL,&#xD;&#xA;&#x9;@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;@Profile nvarchar(max) = NULL, @ContactInfo nvarchar(max) = NULL, &#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = WineProducer_Add&#xD;&#xA;&#x9;@Name = 'Test WP', @NameToShow = NULL, @WebSiteURL = 'http://url.com',&#xD;&#xA;&#x9;@locCountry = 'Italy',&#xD;&#xA;&#x9;@WF_StatusID = NULL,&#xD;&#xA;&#x9;@UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineProducer_Del]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int 

------------ Checks
if not exists(select * from WineProducer (nolock) where ID = @ID) begin
	raiserror('WineProducer_Del:: Wine Producer record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if exists(select * from Wine_VinN (nolock) where ProducerID = @ID) begin
	raiserror('[USERERROR]:: Wine Producer cannot be deleted because there are Wine records associated with this producer.', 16, 1)
	RETURN -1
end

------------ Checks
if len(isnull(@UserName, '')) < 1 begin
	raiserror('WineProducer_Del:: @UserName is required.', 16, 1)
	RETURN -1
end
--exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

BEGIN TRY
	BEGIN TRANSACTION

	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @ID)
	
	delete WineProducer where ID = @ID
	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		exec Audit_Add @Type='Success', @Category='Delete', @Source='SQL', @UserName=@UserName, @MachineName='', 
			@ObjectType='WineProducer', @ObjectID=@ID, @Description='WineProducer deleted', @Message=@msg,
			@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Del].[@ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Del].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Category]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@MachineName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Del].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Del].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Del].[@UserName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Del].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="2317" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/22/2014&#xD;&#xA;-- Description:&#x9;Deletes WineProducer record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineProducer_Del]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#xD;&#xA;&#x9;@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = WineProducer_Del !-- Careful with ID --! @ID=14403, @UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineProducer_GetList]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @TotalRows int
if isnull(@StartRow, 0) < 0 or isnull(@EndRow, 0) <= 0
	select @StartRow = NULL, @EndRow = NULL
select @SortBy = isnull(@SortBy, 'Name'), @SortOrder = lower(isnull(@SortOrder, 'asc'))

if @ID is not null or (@StartRow is null or @EndRow is NULL) begin
	if @Name is NOT NULL 
		select @Name = '%' + @Name + '%'
	select 
		ID = wp.ID,
		Name = wp.Name,
		NameToShow = wp.NameToShow,
		WebSiteURL = wp.WebSiteURL,
		locCountry = lc.Name,
		locRegion = lr.Name,
		locLocation = lloc.Name,
		locLocale = ll.Name,
		locSiteID = ls.Name,
		Profile = wp.Profile,
		ContactInfo = wp.ContactInfo,
		WF_StatusID = wp.WF_StatusID,
		WF_StatusName = wfs.Name,
		created = wp.created, 
		updated = wp.updated,
		CreatorName = isnull(creator.Name, 'system'),
		EditorName = isnull(editor.Name, ''),
		RowNumber = 0,
		TotalRows = 0
	from WineProducer wp (nolock)
		join WF_Statuses wfs (nolock) on wp.WF_StatusID = wfs.ID
		left join LocationCountry lc (nolock) on wp.locCountryID = lc.ID
		left join LocationRegion lr (nolock) on wp.locRegionID = lr.ID
		left join LocationLocation lloc (nolock) on wp.locLocationID = lloc.ID
		left join LocationLocale ll (nolock) on wp.locLocaleID = ll.ID
		left join LocationSite ls (nolock) on wp.locSiteID = ls.ID
		
		left join Audit_EntryUsers creator (nolock) on wp.CreatorID = creator.ID
		left join Audit_EntryUsers editor (nolock) on wp.EditorID = editor.ID
	where wp.ID > 0 
		and (@ID is NULL or wp.ID = @ID)
		and (@Name is NULL or wp.Name like @Name)
	order by Name, NameToShow, ID
end else if @Name is NOT NULL begin
	if @Name is NOT NULL 
		select @Name = '%' + @Name + '%'

	select @TotalRows = count(*) 
	from WineProducer wp (nolock)
	where wp.ID > 0 
		and wp.Name like @Name

	; with r as (
		select 
			ID = wp.ID,
			Name = wp.Name,
			NameToShow = wp.NameToShow,
			WebSiteURL = wp.WebSiteURL,
			locCountry = lc.Name,
			locRegion = lr.Name,
			locLocation = lloc.Name,
			locLocale = ll.Name,
			locSiteID = ls.Name,
			Profile = '',
			ContactInfo = '',
			WF_StatusID = wp.WF_StatusID,
			WF_StatusName = wfs.Name,
			created = wp.created, 
			updated = wp.updated,
			CreatorName = isnull(creator.Name, 'system'),
			EditorName = isnull(editor.Name, ''),
			RowNumber = row_number() over (order by 
				case when @SortBy = 'Name' and @SortOrder = 'asc' then wp.Name else null end asc, 
				case when @SortBy = 'Name' and @SortOrder = 'des' then wp.Name else null end desc,
				case when @SortBy = 'NameToShow' and @SortOrder = 'asc' then wp.NameToShow else null end asc, 
				case when @SortBy = 'NameToShow' and @SortOrder = 'des' then wp.NameToShow else null end desc,
				wp.ID),
			TotalRows = isnull(@TotalRows, 0)
		from WineProducer wp (nolock)
			join WF_Statuses wfs (nolock) on wp.WF_StatusID = wfs.ID
			left join LocationCountry lc (nolock) on wp.locCountryID = lc.ID
			left join LocationRegion lr (nolock) on wp.locRegionID = lr.ID
			left join LocationLocation lloc (nolock) on wp.locLocationID = lloc.ID
			left join LocationLocale ll (nolock) on wp.locLocaleID = ll.ID
			left join LocationSite ls (nolock) on wp.locSiteID = ls.ID
			
			left join Audit_EntryUsers creator (nolock) on wp.CreatorID = creator.ID
			left join Audit_EntryUsers editor (nolock) on wp.EditorID = editor.ID
		where wp.ID > 0 
			and wp.Name like @Name
	)
	select * from r
	where (@StartRow is NULL or @EndRow is NULL or
		RowNumber between @StartRow and @EndRow)
	order by RowNumber, ID
end else begin
	select @TotalRows = count(*) 
	from WineProducer wp (nolock)
	where wp.ID > 0 

	; with r as (
		select 
			ID = wp.ID,
			Name = wp.Name,
			NameToShow = wp.NameToShow,
			WebSiteURL = wp.WebSiteURL,
			locCountry = lc.Name,
			locRegion = lr.Name,
			locLocation = lloc.Name,
			locLocale = ll.Name,
			locSiteID = ls.Name,
			Profile = '',
			ContactInfo = '',
			WF_StatusID = wp.WF_StatusID,
			WF_StatusName = wfs.Name,
			created = wp.created, 
			updated = wp.updated,
			CreatorName = isnull(creator.Name, 'system'),
			EditorName = isnull(editor.Name, ''),
			RowNumber = row_number() over (order by 
				case when @SortBy = 'Name' and @SortOrder = 'asc' then wp.Name else null end asc, 
				case when @SortBy = 'Name' and @SortOrder = 'des' then wp.Name else null end desc,
				case when @SortBy = 'NameToShow' and @SortOrder = 'asc' then wp.NameToShow else null end asc, 
				case when @SortBy = 'NameToShow' and @SortOrder = 'des' then wp.NameToShow else null end desc,
				wp.ID),
			TotalRows = isnull(@TotalRows, 0)
		from WineProducer wp (nolock)
			join WF_Statuses wfs (nolock) on wp.WF_StatusID = wfs.ID
			left join LocationCountry lc (nolock) on wp.locCountryID = lc.ID
			left join LocationRegion lr (nolock) on wp.locRegionID = lr.ID
			left join LocationLocation lloc (nolock) on wp.locLocationID = lloc.ID
			left join LocationLocale ll (nolock) on wp.locLocaleID = ll.ID
			left join LocationSite ls (nolock) on wp.locSiteID = ls.ID

			left join Audit_EntryUsers creator (nolock) on wp.CreatorID = creator.ID
			left join Audit_EntryUsers editor (nolock) on wp.EditorID = editor.ID
		where wp.ID > 0
	)
	select * from r
	where (@StartRow is NULL or @EndRow is NULL or
		RowNumber between @StartRow and @EndRow)
	order by RowNumber, ID
end
	
RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@StartRow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@EndRow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@SortBy]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@SortOrder]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_GetList].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[CreatorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[EditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Profile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ContactInfo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WF_Statuses].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_EntryUsers].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineProducer_GetList].[CTE1].[r]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[NameToShow]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[NameToShow]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[WebSiteURL]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[WebSiteURL]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[locCountry]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationCountry].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[locRegion]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationRegion].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[locLocation]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocation].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[locLocale]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocale].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[locSiteID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationSite].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[Profile]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[ContactInfo]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[WF_StatusID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[WF_StatusID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[WF_StatusName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF_Statuses].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[created]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[created]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[updated]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[updated]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[CreatorName]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[EditorName]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[RowNumber]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE1].[r].[TotalRows]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineProducer_GetList].[CTE2].[r]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[NameToShow]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[NameToShow]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[WebSiteURL]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[WebSiteURL]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[locCountry]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationCountry].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[locRegion]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationRegion].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[locLocation]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocation].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[locLocale]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocale].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[locSiteID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationSite].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[Profile]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[ContactInfo]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[WF_StatusID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[WF_StatusID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[WF_StatusName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WF_Statuses].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[created]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[created]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[updated]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[updated]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[CreatorName]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[EditorName]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[RowNumber]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineProducer_GetList].[CTE2].[r].[TotalRows]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@Name]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@StartRow]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@EndRow]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@SortBy]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_GetList].[@SortOrder]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="3" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="239" />
				<Property Name="Length" Value="6177" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/22/2014&#xD;&#xA;-- Description:&#x9;Gets List of WineProducers.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Input parameters are used as a filter.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineProducer_GetList]&#xD;&#xA;&#x9;@ID int = NULL, @Name nvarchar(100) = NULL,&#xD;&#xA;&#x9;--@NameToShow nvarchar(100) = NULL,&#xD;&#xA;&#x9;--@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;--@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@StartRow int = NULL, @EndRow int = NULL,&#xD;&#xA;&#x9;@SortBy varchar(20) = NULL, @SortOrder varchar(3) = NULL&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;exec WineProducer_GetList @ID = NULL, @Name = 'rob', @StartRow = 15, @EndRow = 20, @SortBy = 'NameToShow'&#xD;&#xA;*/&#xD;&#xA;&#x9;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineProducer_Search]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

select @SearchString = replace(replace(rtrim(ltrim(@SearchString)), '%', ''), '*', '')
if @SearchString is NULL or len(@SearchString) < 1 begin
	raiserror('Search String is required.', 16, 1)
	RETURN -1
end

if @LocationCountryID is NULL and @LocationCountryName is NOT NULL 
	exec @LocationCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@LocationCountryName, @IsAutoCreate=0

--select @SearchString = '%' + replace(@SearchString, ' ', '%') + '%'
select @SearchString = '%' + @SearchString + '%'
if @isDebug = 1
	print @SearchString	

select top(@topNRows)
	ID = wp.ID, 
	Name = wp.Name, 
	NameToShow = wp.NameToShow,
	SortOrder = case when wp.NameToShow like right(@SearchString, len(@SearchString)-1) then 0 else 20 end
from WineProducer wp (nolock)
where wp.NameToShow like @SearchString
	and (@LocationCountryID is NULL or wp.locCountryID = @LocationCountryID)
order by SortOrder, NameToShow, ID

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WineProducer_Search].[@SearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Search].[@LocationCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Search].[@LocationCountryName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Search].[@isDebug]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Search].[@topNRows]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locCountryID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Search].[@SearchString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Search].[@topNRows]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[100]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Search].[@LocationCountryID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Search].[@LocationCountryName]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Search].[@isDebug]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="435" />
				<Property Name="Length" Value="1750" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/26/2014&#xD;&#xA;-- Description:&#x9;Returns list of WineProducer records containing @SearchString in the NameToShow.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Stored procedure requires input parameter @SearchString to be &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;&quot;as user types&quot;, no special characters (*, %, etc.) required and none &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;of them will have special meaning.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineProducer_Search]&#xD;&#xA;&#x9;@SearchString nvarchar(1024), &#xD;&#xA;&#x9;@topNRows int = 100, -- @rankLimit int = 0,&#xD;&#xA;&#x9;@LocationCountryID int = NULL, @LocationCountryName nvarchar(30) = NULL,&#xD;&#xA;&#x9;@isDebug bit = 0&#xD;&#xA;&#xD;&#xA;/*&#xD;&#xA;exec WineProducer_Search @SearchString = 'Domaine du', @LocationCountryName = 'France', @topNRows = 30&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineProducer_Update]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@EditorID int

select @Name = nullif(rtrim(ltrim(@Name)), ''), 
	@NameToShow = nullif(rtrim(ltrim(@NameToShow)), ''),
	@WebSiteURL = nullif(rtrim(ltrim(@WebSiteURL)), '')

------------ Checks
if not exists(select * from WineProducer (nolock) where ID = @ID) begin
	raiserror('WineProducer_Update:: Wine Producer record with ID=%i does not exist.', 16, 1, @ID)
	RETURN -1
end

if @Name is NOT NULL and exists(select * from WineProducer (nolock) where ID != @ID and upper(Name) = upper(@Name)) begin
	raiserror('[USERERROR]:: Wine Producer with the same Name already exists.', 16, 1)
	RETURN -1
end

------------ Checks
if len(isnull(@UserName, '')) < 1 begin
	raiserror('WineProducer_Update:: @UserName is required.', 16, 1)
	RETURN -1
end
exec @EditorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName
------------ Checks

------------ Lookup IDs
declare @locCountryID int, @locRegionID int, @locLocationID int, @locLocaleID int, @locSiteID int
exec @locCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@locCountry, @IsAutoCreate=1
exec @locRegionID = Location_GetLookupID @ObjectName='locRegion', @ObjectValue=@locRegion, @IsAutoCreate=1
exec @locLocationID = Location_GetLookupID @ObjectName='locLocation', @ObjectValue=@locLocation, @IsAutoCreate=1
exec @locLocaleID = Location_GetLookupID @ObjectName='locLocale', @ObjectValue=@locLocale, @IsAutoCreate=1
exec @locSiteID = Location_GetLookupID @ObjectName='locSite', @ObjectValue=@locSite, @IsAutoCreate=1
------------ Lookup IDs

BEGIN TRY
	BEGIN TRANSACTION

	update WineProducer set
		Name = isnull(@Name, Name), 
		NameToShow = isnull(@NameToShow, NameToShow), 
		WebSiteURL = isnull(@WebSiteURL, WebSiteURL),
		locCountryID = case when @locCountry is NULL then locCountryID else @locCountryID end, 
		locRegionID = case when @locRegion is NULL then locRegionID else @locRegionID end, 
		locLocationID = case when @locLocation is NULL then locLocationID else @locLocationID end, 
		locLocaleID = case when @locLocale is NULL then locLocaleID else @locLocaleID end,  
		locSiteID = case when @locSite is NULL then locSiteID else @locSiteID end, 
		[Profile] = isnull(@Profile, Profile), 
		ContactInfo = isnull(@ContactInfo, ContactInfo),
		updated = getdate(), 
		WF_StatusID = isnull(@WF_StatusID, WF_StatusID), 
		EditorID = @EditorID
	where ID = @ID

	select @Result = @@ROWCOUNT
	if @@error <> 0 begin
		select @Result = -1
		ROLLBACK TRAN
	end else begin
		declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('WineProducer', @ID)
		exec Audit_Add @Type='Success', @Category='Update', @Source='SQL', @UserName=@UserName, @MachineName='', 
			@ObjectType='WineProducer', @ObjectID=@ID, @Description='WineProducer updated', @Message=@msg,
			@ShowRes=0
	end

	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WebSiteURL]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Profile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@Profile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ContactInfo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@ContactInfo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[EditorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Category]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Source]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@UserName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@MachineName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ObjectID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Description]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Audit_Add].[@ShowRes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer_Update].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@Name]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@NameToShow]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@WebSiteURL]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@Profile]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@ContactInfo]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@UserName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineProducer_Update].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="4437" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/22/2014&#xD;&#xA;-- Description:&#x9;Updates WineProducer record.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineProducer_Update]&#xD;&#xA;&#x9;@ID int, &#xD;&#xA;&#x9;@Name nvarchar(100) = NULL, @NameToShow nvarchar(100) = NULL,&#xD;&#xA;&#x9;@WebSiteURL nvarchar(255) = NULL,&#xD;&#xA;&#x9;@locCountry nvarchar(50) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;@Profile nvarchar(max) = NULL, @ContactInfo nvarchar(max) = NULL, &#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;@UserName varchar(50),&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = WineProducer_Update&#xD;&#xA;&#x9;!--- careful! @ID = 14403, &#xD;&#xA;&#x9;@Name = '', @NameToShow = 'Testalonga',&#xD;&#xA;&#x9;@locCountry = 'France',&#xD;&#xA;&#x9;@WF_StatusID = 100,&#xD;&#xA;&#x9;@UserName = 'test'&#xD;&#xA;select @r&#xD;&#xA;&#xD;&#xA;*/&#x9;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineType]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineType].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineType].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineType].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="90" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineType].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineType].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="91" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="170" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineType].[IX_WineType_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineType].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineVariety]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVariety].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVariety].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVariety].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="92" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVariety].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVariety].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="93" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="171" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineVariety].[IX_WineVariety_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineVariety].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineVin_GetID]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
set xact_abort on

declare @Result int, 
		@CreatorID int

------------ Checks
if @IsAutoCreate = 1 and 
	(len(isnull(@Producer, '')) < 1 or len(isnull(@WineType, '')) < 1 or len(isnull(@Label, '')) < 1 
	or len(isnull(@Variety, '')) < 1 or len(isnull(@Dryness, '')) < 1 or len(isnull(@Color, '')) < 1)
begin
	select @Result = -1
	raiserror('WineVin_GetID:: Cannot find or register a new WineVin: producer, wine type, label, variety, dryness and color are required.', 16, 1)
	RETURN -1
end
------------ Checks

------------- Audit
--if len(isnull(@UserName, '')) < 1 begin
--	raiserror('WineVin_GetID:: @UserName is required.', 16, 1)
--	RETURN -1
--end
--exec @CreatorID = Audit_GetLookupID @ObjectName = 'entryuser', @ObjectValue = @UserName

BEGIN TRY
	BEGIN TRANSACTION

	------------ Lookup IDs
	declare @ProducerID int, @TypeID int, @LabelID int, @VarietyID int, @DrynessID int,	@ColorID int
	exec @ProducerID = Wine_GetLookupID @ObjectName='wineproducer', @ObjectValue=@Producer, @IsAutoCreate=@IsAutoCreate
	exec @TypeID = Wine_GetLookupID @ObjectName='winetype', @ObjectValue=@WineType, @IsAutoCreate=@IsAutoCreate
	exec @LabelID = Wine_GetLookupID @ObjectName='winelabel', @ObjectValue=@Label, @IsAutoCreate=@IsAutoCreate
	exec @VarietyID = Wine_GetLookupID @ObjectName='winevariety', @ObjectValue=@Variety, @IsAutoCreate=@IsAutoCreate
	exec @DrynessID = Wine_GetLookupID @ObjectName='winedryness', @ObjectValue=@Dryness, @IsAutoCreate=@IsAutoCreate
	exec @ColorID = Wine_GetLookupID @ObjectName='winecolor', @ObjectValue=@Color, @IsAutoCreate=@IsAutoCreate
		
	declare @locCountryID int, @locRegionID int, @locLocationID int, @locLocaleID int, @locSiteID int
	exec @locCountryID = Location_GetLookupID @ObjectName='locCountry', @ObjectValue=@locCountry, @IsAutoCreate=@IsAutoCreate
	exec @locRegionID = Location_GetLookupID @ObjectName='locRegion', @ObjectValue=@locRegion, @IsAutoCreate=@IsAutoCreate
	exec @locLocationID = Location_GetLookupID @ObjectName='locLocation', @ObjectValue=@locLocation, @IsAutoCreate=@IsAutoCreate
	exec @locLocaleID = Location_GetLookupID @ObjectName='locLocale', @ObjectValue=@locLocale, @IsAutoCreate=@IsAutoCreate
	exec @locSiteID = Location_GetLookupID @ObjectName='locSite', @ObjectValue=@locSite, @IsAutoCreate=@IsAutoCreate
	------------ Lookup IDs

	------------ Checks
	if @ProducerID < 1 or @TypeID < 1 or @LabelID < 1 begin
		select @Result = -1
		raiserror('WineVin_GetID:: Cannot find or register a new WineVin: producer, wine type and label are required.', 16, 1)
	end
	------------ Checks

	-- this is a unique key therefore only 1 record can be returned
	select @Result = ID from Wine_VinN
	where ProducerID = @ProducerID and TypeID = @TypeID and LabelID = @LabelID 
		and VarietyID = @VarietyID and DrynessID = @DrynessID and ColorID = @ColorID
		and locCountryID = @locCountryID and locRegionID = @locRegionID 
		and locLocationID = @locLocationID and locLocaleID = @locLocaleID and locSiteID = @locSiteID
	if @Result is NULL begin
		insert into Wine_VinN (GroupID, 
			ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
            locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
			created, updated, WF_StatusID)
		values (0,
			@ProducerID, @TypeID, @LabelID, @VarietyID, @DrynessID, @ColorID,
            @locCountryID, @locRegionID, @locLocationID, @locLocaleID, @locSiteID,
            getdate(), null, isnull(@WF_StatusID, 0))
		if @@error <> 0 begin
			select @Result = -1
			ROLLBACK TRAN
		end else begin
			select @Result = scope_identity()
		--	declare @msg nvarchar(1024) = dbo.fn_GetObjectDescription('Wine_VinN', @Result)
		--	exec Audit_Add @Type='Success', @Category='Add', @Source='SQL', @UserName=@UserName, @MachineName='', 
		--		@ObjectType='Wine_VinN', @ObjectID=@Result, @Description='Wine_VinN added', @Message=@msg,
		--		@ShowRes=0
		end
	end
	
	COMMIT TRANSACTION
END TRY
BEGIN CATCH
	declare @errSeverity int,
			@errMsg nvarchar(2048)
	select	@errSeverity = ERROR_SEVERITY(),
			@errMsg = ERROR_MESSAGE()

    -- Test XACT_STATE:
        -- If 1, the transaction is committable.
        -- If -1, the transaction is uncommittable and should be rolled back.
        -- XACT_STATE = 0 means that there is no transaction and a commit or rollback operation would generate an error.
    if (xact_state() = 1 or xact_state() = -1)
		ROLLBACK TRAN

	raiserror(@errMsg, @errSeverity, 1)
END CATCH

if @ShowRes = 1 ---> always return new ID in the ADD procedure
	select Result = isnull(@Result, -1)

RETURN isnull(@Result, -1)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Producer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Variety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Dryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@Color]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@ObjectValue]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Location_GetLookupID].[@IsAutoCreate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@locSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[created]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[updated]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_GetID].[@ShowRes]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@Producer]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@WineType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@Label]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="120" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@Variety]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@Dryness]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@Color]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@locCountry]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@locRegion]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@locLocation]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@locLocale]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@locSite]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@WF_StatusID]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@IsAutoCreate]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_GetID].[@ShowRes]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="324" />
				<Property Name="Length" Value="5842" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B.&#xD;&#xA;-- Create date: 1/31/2014&#xD;&#xA;-- Description:&#x9;Searches for a WineVin and returns internal ID of the record.&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;If a particular Wine_VinN record cannot be found, it will be created and new ID returned.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineVin_GetID]&#xD;&#xA;&#x9;--@ID int = NULL, &#xD;&#xA;&#x9;@Producer nvarchar(100), @WineType nvarchar(50), @Label nvarchar(120),&#xD;&#xA;&#x9;@Variety nvarchar(50), @Dryness nvarchar(30), @Color nvarchar(30),&#xD;&#xA;&#xD;&#xA;&#x9;@locCountry nvarchar(25) = NULL, @locRegion nvarchar(50) = NULL, &#xD;&#xA;&#x9;@locLocation nvarchar(50) = NULL, @locLocale nvarchar(50) = NULL, @locSite nvarchar(50) = NULL,&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;@WF_StatusID smallint = NULL,&#xD;&#xA;&#x9;--@UserName varchar(50),&#xD;&#xA;&#x9;@IsAutoCreate bit = 1,&#xD;&#xA;&#x9;@ShowRes smallint = 1&#xD;&#xA;&#x9;&#xD;&#xA;/*&#xD;&#xA;declare @r int&#xD;&#xA;exec @r = WineVin_GetID @Producer = 'Gerard Depardieu', @WineType = 'Table', @Label = 'Domaine de St. Augustin',&#xD;&#xA;&#x9;@Variety = 'Proprietary Blend', @Dryness = 'Dry', @Color = 'Red',&#xD;&#xA;&#x9;@locCountry = 'Algeria', @locRegion = 'Coteaux de Tlemcen', &#xD;&#xA;&#x9;@locLocation = 'a', @locLocale = NULL, @locSite = NULL,&#xD;&#xA;&#x9;@WF_StatusID = NULL, @IsAutoCreate = 0&#xD;&#xA;select @r&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineVin_Search]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET NUMERIC_ROUNDABORT OFF

select @SearchString = replace(replace(rtrim(ltrim(@SearchString)), '%', ''), '*', '')

if @SearchString is NULL or len(@SearchString) < 2 begin
	raiserror('Search String is required.', 16, 1)
	RETURN -1
end

if @isDebug = 1
	print @SearchString

--------- Results --------
create table #t (
	Wine_VinN_ID int not null, 
	Wine_VinN_GroupID int null,
	WF_StatusID smallint null,
	locCountryID int null, locRegionID int null, locLocationID int null, locLocaleID int null, locSiteID int null,
	ProducerID int null, TypeID int null, LabelID int null, VarietyID int null, DrynessID int null, ColorID int null,
	SortOrder smallint null
)

if isnull(lower(@FieldNameToSearch), '') in ('', 'labelname') begin
	select	@SearchString = '%' + replace(@SearchString, ' ', '%') + '%'
	if @isDebug = 1
		print @SearchString	
	
	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 0 else 20 end
		from WineLabel (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.LabelID
	order by f.SortOrder, f.Name;
end else if lower(@FieldNameToSearch) = 'extendedlabel' begin
	select	@SearchString = '%' + replace(@SearchString, ' ', '%') + '%'
	if @isDebug = 1
		print @SearchString	

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 10 else 20 end
		from WineLabel (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.LabelID
	order by f.SortOrder, f.Name;
	
	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 12 else 22 end
		from WineProducer (nolock)
		where NameToShow like @SearchString
	)
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.LabelID
	order by f.SortOrder, f.Name;

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 14 else 24 end
		from WineVariety (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.LabelID
	order by f.SortOrder, f.Name;
end else if lower(@FieldNameToSearch) = 'appellation' begin
	-- Appellation = coalesce(Site.Name, Locale.name, Location.name, Region.name, Country.name),
	select	@SearchString = '%' + replace(@SearchString, ' ', '%') + '%'
	if @isDebug = 1
		print @SearchString	

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 10 else 40 end
		from LocationSite (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows/2)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.locSiteID
	order by f.SortOrder, f.Name;

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 12 else 42 end
		from LocationLocale (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows/2)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.locLocaleID
	order by f.SortOrder, f.Name;

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 14 else 44 end
		from LocationLocation (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows/2)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.locLocationID
	order by f.SortOrder, f.Name;

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 16 else 46 end
		from LocationRegion (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows/2)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.locRegionID
	order by f.SortOrder, f.Name;

	; with f as (
		select ID, Name, 
			SortOrder = case when Name like right(@SearchString, len(@SearchString)-1) then 18 else 48 end
		from LocationCountry (nolock)
		where Name like @SearchString
	)
	insert into #t
	select top(@topNRows/2)
		Wine_VinN_ID = v.ID, Wine_VinN_GroupID = v.GroupID, 
		Wine_VinN_WF_StatusID = v.WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = f.SortOrder
	from f
		join Wine_VinN v on f.ID = v.locCountryID
	order by f.SortOrder, f.Name;

end else begin
	select @SearchString = '"' + replace(@SearchString, ' ', '*" and "') + '*"'
	if @isDebug = 1
		print @SearchString	

	select 
		Wine_VinN_ID = v.Wine_VinN_ID, 
		Label = v.Label,
		Producer = v.Producer, 
		ProducerToShow = v.ProducerToShow,
		Country = v.Country, Region = v.Region, Location = v.Location, Locale = v.Locale, Site = v.Site,
		Appellation = v.Appellation,
		Color = v.Color, Variety = v.Variety, Dryness = v.Dryness, WineType = v.[Type], 
		WF_StatusID = v.Wine_VinN_WF_StatusID
		--fts.RANK
	from vWineVinNDetails v
		join containstable(vWineVinNDetails, *, @SearchString, @topNRows) fts
			on v.Wine_VinN_ID = fts.[KEY]
	where fts.RANK > @rankLimit
	order by fts.RANK desc
	
	RETURN 1
end

/*
select top(@topNRows)
	Wine_VinN_ID = r.Wine_VinN_ID, 
	Label, Producer, ProducerToShow,
	Country, Region, Location, Locale, Site, Appellation,
	Color, Variety, Dryness, WineType = v.[Type], 
	WF_StatusID = r.WF_StatusID
from #t r
	join vWineVinNDetails v on r.Wine_VinN_ID = v.Wine_VinN_ID
order by SortOrder, Label, ProducerToShow, Variety
*/

select top(@topNRows)
	Wine_VinN_ID = r.Wine_VinN_ID, 
	Label = wl.Name,
	Producer = wp.Name, 
	ProducerToShow = wp.NameToShow,
	
	Country = lc.Name, Region = lr.Name, 
	Location = ll.Name, 
	Locale = lloc.Name, Site = ls.Name,
	Appellation = coalesce(
		nullif(ls.Name,''), nullif(lloc.name,''), nullif(ll.name,''), nullif(lr.name,''), nullif(lc.name,'')
	),
		
	Color = wc.Name,
	Variety = wv.Name, 
	Dryness = wd.Name,
	WineType = wt.Name, 

	WF_StatusID = r.WF_StatusID
from #t r
	join dbo.LocationCountry lc (nolock) on r.locCountryID = lc.ID
	join dbo.LocationRegion lr (nolock) on r.locRegionID = lr.ID
	join dbo.LocationLocation ll (nolock) on r.locLocationID = ll.ID
	join dbo.LocationLocale lloc (nolock) on r.locLocaleID = lloc.ID
	join dbo.LocationSite ls (nolock) on r.locSiteID = ls.ID

	join dbo.WineProducer wp (nolock) on r.ProducerID = wp.ID
	join dbo.WineType wt (nolock) on r.TypeID = wt.ID
	join dbo.WineLabel wl (nolock) on r.LabelID = wl.ID
	join dbo.WineVariety wv (nolock) on r.VarietyID = wv.ID
	join dbo.WineDryness wd (nolock) on r.DrynessID = wd.ID
	join dbo.WineColor wc (nolock) on r.ColorID = wc.ID
order by SortOrder, Label, Producer, Variety, Country
drop table #t

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WineVin_Search].[@SearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[@isDebug]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[@FieldNameToSearch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[@topNRows]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Wine_VinN].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Producer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[ProducerToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Country]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Region]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Location]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Locale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Site]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Appellation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Color]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Variety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Dryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Type]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_WF_StatusID]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[WineVin_Search].[@rankLimit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_Search].[#t].[SortOrder]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[#t]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[Wine_VinN_ID]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[Wine_VinN_GroupID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[WF_StatusID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[smallint]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[locCountryID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[locRegionID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[locLocationID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[locLocaleID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[locSiteID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[ProducerID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[TypeID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[LabelID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[VarietyID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[DrynessID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[ColorID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_Search].[#t].[SortOrder]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[smallint]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE1].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE1].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineLabel].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE1].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineLabel].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE1].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE2].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE2].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineLabel].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE2].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineLabel].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE2].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE3].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE3].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE3].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineProducer].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE3].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE4].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE4].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineVariety].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE4].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[WineVariety].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE4].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE5].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE5].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationSite].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE5].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationSite].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE5].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE6].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE6].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocale].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE6].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocale].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE6].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE7].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE7].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocation].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE7].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationLocation].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE7].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE8].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE8].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationRegion].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE8].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationRegion].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE8].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_Search].[CTE9].[f]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE9].[f].[ID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationCountry].[ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE9].[f].[Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[LocationCountry].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[WineVin_Search].[CTE9].[f].[SortOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_Search].[@SearchString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_Search].[@FieldNameToSearch]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_Search].[@topNRows]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[100]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_Search].[@rankLimit]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_Search].[@isDebug]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="413" />
				<Property Name="Length" Value="9710" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/20/2014&#xD;&#xA;-- Description:&#x9;Returns list of Wine_VinN records containing @SearchString&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Stored procedure requires input parameter @SearchString to be &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;&quot;as user types&quot;, no special characters (*, %, etc.) required and none &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;of them will have special meaning.&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineVin_Search]&#xD;&#xA;&#x9;@SearchString nvarchar(1024), &#xD;&#xA;&#x9;@FieldNameToSearch varchar(30) = NULL,&#xD;&#xA;&#x9;@topNRows int = 100, @rankLimit int = 0,&#xD;&#xA;&#x9;@isDebug bit = 0&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WineVin_SearchFT]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET NUMERIC_ROUNDABORT OFF

--select @SearchString = replace(replace(rtrim(ltrim(@SearchString)), '%', '*'), '  ', ' ')
--if lower(@FieldNameToSearch) = 'labelname' begin
--	-- applying macroses
--	select @SearchString = dbo.fn_GetAdjustedSearchString(@SearchString)
--end

if @isDebug = 1
	print @SearchString

--------- Results --------
create table #t (
	Wine_VinN_ID int not null, 
	Wine_VinN_GroupID int null,
	WF_StatusID smallint null,
	locCountryID int null, locRegionID int null, locLocationID int null, locLocaleID int null, locSiteID int null,
	ProducerID int null, TypeID int null, LabelID int null, VarietyID int null, DrynessID int null, ColorID int null,
	SortOrder smallint null
)

if lower(@FieldNameToSearch) = 'labelname' begin
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID, Wine_VinN_GroupID, Wine_VinN_WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = fts.RANK
	from vWineVinNDetails v
		join containstable(vWineVinNDetails, Label, @SearchString, @topNRows) fts
			on v.Wine_VinN_ID = fts.[KEY]
	where fts.RANK > @rankLimit
end else if lower(@FieldNameToSearch) = 'extendedlabel' begin
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID, Wine_VinN_GroupID, Wine_VinN_WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = fts.RANK
	from vWineVinNDetails v
		join containstable(vWineVinNDetails, (ProducerToShow, Label, Variety), @SearchString, @topNRows) fts
			on v.Wine_VinN_ID = fts.[KEY]
	where fts.RANK > @rankLimit
end else if lower(@FieldNameToSearch) = 'appellation' begin
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID, Wine_VinN_GroupID, Wine_VinN_WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = fts.RANK
	from vWineVinNDetails v
		join containstable(vWineVinNDetails, Appellation, @SearchString, @topNRows) fts
			on v.Wine_VinN_ID = fts.[KEY]
	where fts.RANK > @rankLimit
end else begin
	insert into #t
	select top(@topNRows)
		Wine_VinN_ID, Wine_VinN_GroupID, Wine_VinN_WF_StatusID,
		locCountryID, locRegionID, locLocationID, locLocaleID, locSiteID,
		ProducerID, TypeID, LabelID, VarietyID, DrynessID, ColorID,
		SortOrder = fts.RANK
	from vWineVinNDetails v
		join containstable(vWineVinNDetails, *, @SearchString, @topNRows) fts
			on v.Wine_VinN_ID = fts.[KEY]
	where fts.RANK > @rankLimit
end

if @@rowcount > 100 begin
	if @isDebug = 1
		print '--- Creating Index on #t ---'
	CREATE NONCLUSTERED INDEX [IX_t] ON #t (
		[ColorID] ASC
	) WITH (SORT_IN_TEMPDB = ON);
end

select --top(@topNRows)
	Wine_VinN_ID = r.Wine_VinN_ID, 
	Label = wl.Name,
	Producer = wp.Name, 
	ProducerToShow = wp.NameToShow,
	
	Country = lc.Name, Region = lr.Name, 
	Location = ll.Name, 
	Locale = lloc.Name, Site = ls.Name,
	Appellation = coalesce(
		nullif(ls.Name,''), nullif(lloc.name,''), nullif(ll.name,''), nullif(lr.name,''), nullif(lc.name,'')
	),
		
	Color = wc.Name,
	Variety = wv.Name, 
	Dryness = wd.Name,
	WineType = wt.Name, 

	WF_StatusID = r.WF_StatusID
from #t r
	join dbo.LocationCountry lc (nolock) on r.locCountryID = lc.ID
	join dbo.LocationRegion lr (nolock) on r.locRegionID = lr.ID
	join dbo.LocationLocation ll (nolock) on r.locLocationID = ll.ID
	join dbo.LocationLocale lloc (nolock) on r.locLocaleID = lloc.ID
	join dbo.LocationSite ls (nolock) on r.locSiteID = ls.ID

	join dbo.WineProducer wp (nolock) on r.ProducerID = wp.ID
	join dbo.WineType wt (nolock) on r.TypeID = wt.ID
	join dbo.WineLabel wl (nolock) on r.LabelID = wl.ID
	join dbo.WineVariety wv (nolock) on r.VarietyID = wv.ID
	join dbo.WineDryness wd (nolock) on r.DrynessID = wd.ID
	join dbo.WineColor wc (nolock) on r.ColorID = wc.ID
order by SortOrder, Label, Producer, Variety, Country

drop table #t

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[@isDebug]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[@SearchString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[@FieldNameToSearch]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[@topNRows]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_GroupID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Wine_VinN_WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[ColorID]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[@rankLimit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[ProducerToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Variety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineVinNDetails].[Appellation]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[locCountryID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[locRegionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[locLocationID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[locLocaleID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[locSiteID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[ProducerID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[TypeID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[VarietyID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[Wine_VinN_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineProducer].[NameToShow]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationSite].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocale].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationLocation].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationRegion].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LocationCountry].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineColor].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVariety].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineDryness].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineType].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[WF_StatusID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT].[#t].[SortOrder]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[WineVin_SearchFT].[#t]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[Wine_VinN_ID]">
									<Property Name="IsNullable" Value="False" />
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[Wine_VinN_GroupID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[WF_StatusID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[smallint]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[locCountryID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[locRegionID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[locLocationID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[locLocaleID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[locSiteID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[ProducerID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[TypeID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[LabelID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[VarietyID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[DrynessID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[ColorID]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[dbo].[WineVin_SearchFT].[#t].[SortOrder]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[smallint]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_SearchFT].[@SearchString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_SearchFT].[@FieldNameToSearch]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_SearchFT].[@topNRows]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[100]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_SearchFT].[@rankLimit]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WineVin_SearchFT].[@isDebug]">
						<Property Name="DefaultExpressionScript">
							<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="333" />
				<Property Name="Length" Value="4741" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Alex B&#xD;&#xA;-- Create date: 1/20/2014&#xD;&#xA;-- Description:&#x9;Returns list of Wine_VinN records containing @SearchString&#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;Stored procedure requires input parameter @SearchString to be well formatted for &#xD;&#xA;--&#x9;&#x9;&#x9;&#x9;CONTAINSTABLE&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[WineVin_SearchFT]&#xD;&#xA;&#x9;@SearchString nvarchar(1024), &#xD;&#xA;&#x9;@FieldNameToSearch varchar(30) = NULL,&#xD;&#xA;&#x9;@topNRows int = 100, @rankLimit int = 0,&#xD;&#xA;&#x9;@isDebug bit = 0&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[WineVintage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVintage].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Property Name="IdentitySeed" Value="0" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVintage].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVintage].[created]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="94" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVintage].[updated]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[WineVintage].[WF_StatusID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="95" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="172" />
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[WineVintage].[IX_WineVintage_Uniq]">
			<Property Name="IsUnique" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[WineVintage].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[dbo].[WineVintage].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[WineVintage]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[public].[dbo].[dbo].[Audit_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Audit_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[public].[dbo].[dbo].[Audit_GetLookupID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Audit_GetLookupID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[public].[dbo].[dbo].[WF_ObjectTypes_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[public].[dbo].[dbo].[WF_Statuses_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_Statuses_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[public].[dbo].[dbo].[WF_Users_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_Users_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[fn_GetAdjustedSearchString]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[Issue_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Issue_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[Location_GetLookupID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[TasteNote_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TasteNote_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[TastingEvent_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[Wine_GetList_ByVinID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_GetList_ByVinID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[Wine_GetLookupID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[Wine_SearchFT]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_SearchFT]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[WineProducer_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[WineProducer_Search]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_Search]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[WineVin_Search]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineVin_Search]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_Customer].[dbo].[dbo].[WineVin_SearchFT]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Audit_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Audit_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[fn_GetAdjustedSearchString]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[fn_GetObjectDescription]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[fn_GetObjectDescription]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Issue_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Issue_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Issue_Del]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Issue_Del]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Issue_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Issue_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Issue_Update]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Issue_Update]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Location_GetLookupID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Location_GetLookupID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TasteNote_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TasteNote_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TasteNote_Del]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TasteNote_Del]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TasteNote_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TasteNote_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TasteNote_Update]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TasteNote_Update]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_Del]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_Del]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_TasteNote_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_TasteNote_AddTVP]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_AddTVP]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_TasteNote_Del]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_TasteNote_Del]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[TastingEvent_Update]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[TastingEvent_Update]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_AddUpdate]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_AddUpdate]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_GetHist]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_GetHist]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_GetStats]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_GetStats]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_ObjectTypes_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_ObjectTypes_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_Statuses_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_Statuses_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WF_Users_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WF_Users_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Wine_GetID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_GetID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Wine_GetList_ByVinID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_GetList_ByVinID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Wine_GetLookupID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_GetLookupID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[Wine_SearchFT]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[Wine_SearchFT]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineProducer_Add]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_Add]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineProducer_Del]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_Del]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineProducer_GetList]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_GetList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineProducer_Search]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_Search]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineProducer_Update]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineProducer_Update]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineVin_GetID]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineVin_GetID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineVin_Search]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineVin_Search]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Execute.Object].[RP_DataAdmin].[dbo].[dbo].[WineVin_SearchFT]">
			<Property Name="Permission" Value="1070" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[WineVin_SearchFT]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Object].[RP_Customer].[dbo].[dbo].[fn_GetAdjustedSearchString]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Object].[RP_DataAdmin].[dbo].[dbo].[fn_GetAdjustedSearchString]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[fn_GetAdjustedSearchString]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Type].[RP_Customer].[dbo].[dbo].[IDLink]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDLink]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Type].[RP_Customer].[dbo].[dbo].[IDList]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Type].[RP_DataAdmin].[dbo].[dbo].[IDLink]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDLink]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.References.Type].[RP_DataAdmin].[dbo].[dbo].[IDList]">
			<Property Name="Permission" Value="5" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Select.Object].[public].[dbo].[dbo].[String2Table]">
			<Property Name="Permission" Value="2" />
			<Relationship Name="Grantee">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[public]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[String2Table]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Select.Object].[RP_Customer].[dbo].[dbo].[vWineDetails]">
			<Property Name="Permission" Value="2" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Select.Object].[RP_Customer].[dbo].[dbo].[vWineVinNDetails]">
			<Property Name="Permission" Value="2" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Select.Object].[RP_DataAdmin].[dbo].[dbo].[vWineDetails]">
			<Property Name="Permission" Value="2" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.Select.Object].[RP_DataAdmin].[dbo].[dbo].[vWineVinNDetails]">
			<Property Name="Permission" Value="2" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[vWineVinNDetails]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.ViewDefinition.Type].[RP_Customer].[dbo].[dbo].[IDLink]">
			<Property Name="Permission" Value="1088" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDLink]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.ViewDefinition.Type].[RP_Customer].[dbo].[dbo].[IDList]">
			<Property Name="Permission" Value="1088" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_Customer]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.ViewDefinition.Type].[RP_DataAdmin].[dbo].[dbo].[IDLink]">
			<Property Name="Permission" Value="1088" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDLink]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPermissionStatement" Name="[Grant.ViewDefinition.Type].[RP_DataAdmin].[dbo].[dbo].[IDList]">
			<Property Name="Permission" Value="1088" />
			<Relationship Name="Grantee">
				<Entry>
					<References Name="[RP_DataAdmin]" />
				</Entry>
			</Relationship>
			<Relationship Name="Grantor">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="SecuredObject">
				<Entry>
					<References Name="[dbo].[IDList]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlRole" Name="[RP_Customer]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlRole" Name="[RP_DataAdmin]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlFullTextCatalog" Name="[RPOWine_FTSearchVin]">
			<Property Name="IsAccentSensitive" Value="True" />
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlFullTextCatalog" Name="[RPOWine_FTSearchWine]">
			<Property Name="IsAccentSensitive" Value="True" />
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlExtendedProperty" Name="[SqlColumn].[dbo].[TasteNote].[OriginID].[MS_Description]">
			<Property Name="Value">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[N'Used to track changes for already published Taste Notes.']]></Value>
			</Property>
			<Relationship Name="Host">
				<Entry>
					<References Name="[dbo].[TasteNote].[OriginID]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[srv]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[srv].[WineLabel_ResetDefaults]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

begin tran 
	update WineLabel set DefaultColorID = -1, DefaultDrynessID = -1
	
	; with 
	tot as (
		select Label, LabelID, cnt = count(*)
		from vWineDetails
		where Label != ''
		group by Label, LabelID
	)
	, 
	stat as (
		select Label, LabelID, Dryness, DrynessID, Color, ColorID, cnt = count(*)
		from vWineDetails
		where Label != ''
		group by Label, LabelID, Dryness, DrynessID, Color, ColorID
	)
	--select stat.*, Total = tot.cnt, Prob = cast(stat.cnt as money) / tot.cnt
	update WineLabel set 
		DefaultColorID = stat.ColorID,
		DefaultDrynessID = stat.DrynessID
	from WineLabel 
		join tot on tot.LabelID = WineLabel.ID
		join stat on tot.LabelID = stat.LabelID
	where tot.cnt > 100 and (cast(stat.cnt as money) / tot.cnt) > 0.8	-- probability > 80%
commit tran

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[WineLabel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[DefaultDrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Label]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Dryness]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[DrynessID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[Color]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WineLabel].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[LabelID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[ColorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[vWineDetails].[DrynessID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[money]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[tot]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[tot].[Label]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Label]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[tot].[LabelID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[LabelID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[tot].[cnt]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[Label]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Label]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[LabelID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[LabelID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[Dryness]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Dryness]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[DrynessID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[DrynessID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[Color]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[Color]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[ColorID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[vWineDetails].[ColorID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[srv].[WineLabel_ResetDefaults].[CTE1].[stat].[cnt]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[srv]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1005" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE srv.WineLabel_ResetDefaults&#xD;&#xA;&#xD;&#xA;--&#xD;&#xA;-- Computes and resets default ColorID and DrynessID in WineLabel Table.&#xD;&#xA;-- Used to correctly form Name (computed).&#xD;&#xA;--&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlFilegroup" Name="[TasteNotes]" />
		<Element Type="SqlSchema" Name="[utils]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[utils].[tools_FullTextSearch_Set]">
			<Property Name="BodyScript">
				<Value QuotedIdentifiers="True" AnsiNulls="True"><![CDATA[
set nocount on

declare @DBName varchar(30) = rtrim(db_name()),
		@FTCatalogName varchar(30)
		
--EXEC sp_fulltext_database @action = 'enable' 

-- register an empty stop list
CREATE FULLTEXT STOPLIST [RPOWineDataStopList]
AUTHORIZATION [dbo];

------------- Wines ----------
--EXEC sp_fulltext_catalog @ftcat = 'RPOWine_FTSearchWine', @action = 'create'

--CREATE FULLTEXT INDEX ON [dbo].[vWineDetails](
--[Color] LANGUAGE [English], 
--[Country] LANGUAGE [English], 
--[Dryness] LANGUAGE [English], 
--[Label] LANGUAGE [English], 
--[Locale] LANGUAGE [English], 
--[Location] LANGUAGE [English], 
--[Producer] LANGUAGE [English], 
--[Region] LANGUAGE [English], 
--[Site] LANGUAGE [English], 
--[Variety] LANGUAGE [English], 
--[Vintage] LANGUAGE [English], 
--[Type] LANGUAGE [English])
--KEY INDEX [PK_vWineDetails]ON ([RPOWine_FTSearchWine], FILEGROUP [WineIndx])
--WITH (CHANGE_TRACKING = AUTO, STOPLIST = OFF);

--------------------------------------------------------------------

RETURN 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" Type="SqlUser" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[utils]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="1365" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [utils].[tools_FullTextSearch_Set]&#xD;&#xA;--&#xD;&#xA;---------- setting up a full-text search catalog -------------&#xD;&#xA;--&#xD;&#xA;-- Do not forget to set 'text in row' option for a tables with varchar(max)-like fields&#xD;&#xA;--&#x9;exec sp_tableoption @TableNamePattern = '&lt;TableName&gt;', @OptionName = 'text in row', @OptionValue = '256' &#xD;&#xA;--&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlFilegroup" Name="[WF]" />
		<Element Type="SqlFilegroup" Name="[Wine]" />
		<Element Type="SqlFilegroup" Name="[WineIndx]" />
	</Model>
</DataSchemaModel>